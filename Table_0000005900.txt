OBJECT Table 5900 Service Header
{
  OBJECT-PROPERTIES
  {
    Date=15/09/15;
    Time=12:00:00;
    Version List=NAVW19.00;
  }
  PROPERTIES
  {
    Permissions=TableData 5914=d,
                TableData 5950=rimd;
    DataCaptionFields=No.,Name,Description;
    OnInsert=VAR
               ServShptHeader@1001 : Record 5990;
             BEGIN
               ServSetup.GET ;
               IF "No." = '' THEN BEGIN
                 TestNoSeries;
                 NoSeriesMgt.InitSeries(GetNoSeriesCode,xRec."No. Series",0D,"No.","No. Series");
               END;

               ServShptHeader.SETCURRENTKEY("Order No.");
               ServShptHeader.SETRANGE("Order No.","No.");
               IF ServShptHeader.FINDFIRST THEN
                 ERROR(Text008,FORMAT("Document Type"),FIELDCAPTION("No."),"No.");

               InitRecord;

               CLEAR(ServLogMgt);
               ServLogMgt.ServHeaderCreate(Rec);

               IF GETFILTER("Customer No.") <> '' THEN BEGIN
                 CLEAR(xRec."Ship-to Code");
                 IF GETRANGEMIN("Customer No.") = GETRANGEMAX("Customer No.") THEN
                   VALIDATE("Customer No.",GETRANGEMIN("Customer No."));
               END;

               IF GETFILTER("Contact No.") <> '' THEN
                 IF GETRANGEMIN("Contact No.") = GETRANGEMAX("Contact No.") THEN
                   VALIDATE("Contact No.",GETRANGEMIN("Contact No."));
             END;

    OnModify=BEGIN
               UpdateServiceOrderChangeLog(xRec);
             END;

    OnDelete=VAR
               ServDocRegister@1000 : Record 5936;
               ServDocLog@1001 : Record 5912;
               WhseRequest@1003 : Record 5765;
               ServAllocMgt@1002 : Codeunit 5930;
             BEGIN
               IF NOT UserSetupMgt.CheckRespCenter(2,"Responsibility Center") THEN
                 ERROR(
                   Text000,
                   RespCenter.TABLECAPTION,UserSetupMgt.GetServiceFilter);

               IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                 ServLine.RESET;
                 ServLine.SETRANGE("Document Type",ServLine."Document Type"::Invoice);
                 ServLine.SETRANGE("Document No.","No.");
                 ServLine.SETFILTER("Appl.-to Service Entry",'>%1',0);
                 IF NOT ServLine.ISEMPTY THEN
                   ERROR(Text046,"No.");
               END;

               ServPost.DeleteHeader(
                 Rec,ServShptHeader,ServInvHeader,ServCrMemoHeader);
               VALIDATE("Applies-to ID",'');

               ServLine.RESET;
               ServLine.LOCKTABLE;

               HandleItemTrackingDeletion;

               WhseRequest.SETRANGE("Source Type",DATABASE::"Service Line");
               WhseRequest.SETRANGE("Source Subtype","Document Type");
               WhseRequest.SETRANGE("Source No.","No.");
               WhseRequest.DELETEALL(TRUE);

               ServLine.SETRANGE("Document Type","Document Type");
               ServLine.SETRANGE("Document No.","No.");
               ServLine.SuspendStatusCheck(TRUE);
               ServLine.DELETEALL(TRUE);

               ServCommentLine.RESET;
               ServCommentLine.SETRANGE("Table Name",ServCommentLine."Table Name"::"Service Header");
               ServCommentLine.SETRANGE("Table Subtype","Document Type");
               ServCommentLine.SETRANGE("No.","No.");
               ServCommentLine.DELETEALL;

               ServDocRegister.SETCURRENTKEY("Destination Document Type","Destination Document No.");
               CASE "Document Type" OF
                 "Document Type"::Invoice:
                   BEGIN
                     ServDocRegister.SETRANGE("Destination Document Type",ServDocRegister."Destination Document Type"::Invoice);
                     ServDocRegister.SETRANGE("Destination Document No.","No.");
                     ServDocRegister.DELETEALL;
                   END;
                 "Document Type"::"Credit Memo":
                   BEGIN
                     ServDocRegister.SETRANGE("Destination Document Type",ServDocRegister."Destination Document Type"::"Credit Memo");
                     ServDocRegister.SETRANGE("Destination Document No.","No.");
                     ServDocRegister.DELETEALL;
                   END;
               END;

               IF (ServShptHeader."No." <> '') OR
                  (ServInvHeader."No." <> '') OR
                  (ServCrMemoHeader."No." <> '')
               THEN BEGIN
                 COMMIT;

                 IF ServShptHeader."No." <> '' THEN
                   IF CONFIRM(Text048,TRUE,ServShptHeader."No.") THEN BEGIN
                     ServShptHeader.SETRECFILTER;
                     ServShptHeader.PrintRecords(TRUE);
                   END;

                 IF ServInvHeader."No." <> '' THEN
                   IF CONFIRM(Text049,TRUE,ServInvHeader."No.") THEN BEGIN
                     ServInvHeader.SETRECFILTER;
                     ServInvHeader.PrintRecords(TRUE);
                   END;

                 IF ServCrMemoHeader."No." <> '' THEN
                   IF CONFIRM(Text002,TRUE,ServCrMemoHeader."No.") THEN BEGIN
                     ServCrMemoHeader.SETRECFILTER;
                     ServCrMemoHeader.PrintRecords(TRUE);
                   END;
               END;

               ServOrderAlloc.RESET;
               ServOrderAlloc.SETCURRENTKEY("Document Type");
               ServOrderAlloc.SETRANGE("Document Type","Document Type");
               ServOrderAlloc.SETRANGE("Document No.","No.");
               ServOrderAlloc.SETRANGE(Posted,FALSE);
               ServOrderAlloc.DELETEALL;
               ServAllocMgt.SetServOrderAllocStatus(Rec);

               ServItemLine.RESET;
               ServItemLine.SETRANGE("Document Type","Document Type");
               ServItemLine.SETRANGE("Document No.","No.");
               IF ServItemLine.FIND('-') THEN
                 REPEAT
                   IF ServItemLine."Loaner No." <> '' THEN BEGIN
                     Loaner.GET(ServItemLine."Loaner No.");
                     LoanerEntry.RESET;
                     LoanerEntry.SETCURRENTKEY("Document Type","Document No.","Loaner No.",Lent);
                     LoanerEntry.SETRANGE("Document Type","Document Type" + 1);
                     LoanerEntry.SETRANGE("Document No.","No.");
                     LoanerEntry.SETRANGE("Loaner No.",ServItemLine."Loaner No.");
                     LoanerEntry.SETRANGE(Lent,TRUE);
                     IF LoanerEntry.FINDFIRST THEN
                       ERROR(
                         Text040,
                         TABLECAPTION,
                         ServItemLine."Document No.",
                         ServItemLine."Line No.",
                         ServItemLine.FIELDCAPTION("Loaner No."),
                         ServItemLine."Loaner No.");

                     LoanerEntry.SETRANGE(Lent,TRUE);
                     LoanerEntry.DELETEALL;
                   END;

                   CLEAR(ServLogMgt);
                   ServLogMgt.ServItemOffServOrder(ServItemLine);
                   ServItemLine.DELETE;
                 UNTIL ServItemLine.NEXT = 0;

               ServDocLog.RESET;
               ServDocLog.SETRANGE("Document Type","Document Type");
               ServDocLog.SETRANGE("Document No.","No.");
               ServDocLog.DELETEALL;

               ServDocLog.RESET;
               ServDocLog.SETRANGE(Before,"No.");
               ServDocLog.SETFILTER("Document Type",'%1|%2|%3',
                 ServDocLog."Document Type"::Shipment,ServDocLog."Document Type"::"Posted Invoice",
                 ServDocLog."Document Type"::"Posted Credit Memo");
               ServDocLog.DELETEALL;
             END;

    OnRename=BEGIN
               ERROR(Text044,TABLECAPTION);
             END;

    CaptionML=[ENU=Service Header;
               FRA=En-tˆte service];
    LookupPageID=Page5901;
    DrillDownPageID=Page5901;
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              FRA=Type document];
                                                   OptionCaptionML=[ENU=Quote,Order,Invoice,Credit Memo;
                                                                    FRA=Devis,Commande,Facture,Avoir];
                                                   OptionString=Quote,Order,Invoice,Credit Memo }
    { 2   ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF ("Customer No." <> xRec."Customer No.") AND (xRec."Customer No." <> '') THEN BEGIN
                                                                  IF "Contract No." <> '' THEN
                                                                    ERROR(
                                                                      Text003,
                                                                      FIELDCAPTION("Customer No."),
                                                                      "Document Type",FIELDCAPTION("No."),"No.",
                                                                      FIELDCAPTION("Contract No."),"Contract No.");
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    IF ServItemLineExists THEN
                                                                      Confirmed :=
                                                                        CONFIRM(
                                                                          Text004,
                                                                          FALSE,FIELDCAPTION("Customer No."))
                                                                    ELSE
                                                                      IF ServLineExists THEN
                                                                        Confirmed :=
                                                                          CONFIRM(
                                                                            Text057,
                                                                            FALSE,FIELDCAPTION("Customer No."))
                                                                      ELSE
                                                                        Confirmed := CONFIRM(Text005,FALSE,FIELDCAPTION("Customer No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      ServLine.SETFILTER("Quantity Shipped",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                                                                        ServLine.SETRANGE("Customer No.",xRec."Customer No.");
                                                                        ServLine.SETFILTER("Shipment No.",'<>%1','');
                                                                      END;

                                                                    IF ServLine.FINDFIRST THEN BEGIN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        ServLine.TESTFIELD("Quantity Shipped",0)
                                                                      ELSE
                                                                        ServLine.TESTFIELD("Shipment No.",'');
                                                                    END;
                                                                    MODIFY(TRUE);

                                                                    ServLine.LOCKTABLE;
                                                                    ServLine.RESET;
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    ServLine.DELETEALL(TRUE);

                                                                    ServItemLine.LOCKTABLE;
                                                                    ServItemLine.RESET;
                                                                    ServItemLine.SETRANGE("Document Type","Document Type");
                                                                    ServItemLine.SETRANGE("Document No.","No.");
                                                                    ServItemLine.DELETEALL(TRUE);

                                                                    GET("Document Type","No.");
                                                                    IF "Customer No." = '' THEN BEGIN
                                                                      INIT;
                                                                      ServSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                GetCust("Customer No.");
                                                                IF "Customer No." <> '' THEN BEGIN
                                                                  Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);
                                                                  Cust.TESTFIELD("Gen. Bus. Posting Group");
                                                                  Name := Cust.Name;
                                                                  "Name 2" := Cust."Name 2";
                                                                  Address := Cust.Address;
                                                                  "Address 2" := Cust."Address 2";
                                                                  City := Cust.City;
                                                                  "Post Code" := Cust."Post Code";
                                                                  County := Cust.County;
                                                                  "Country/Region Code" := Cust."Country/Region Code";
                                                                  IF NOT SkipContact THEN BEGIN
                                                                    "Contact Name" := Cust.Contact;
                                                                    "Phone No." := Cust."Phone No.";
                                                                    "E-Mail" := Cust."E-Mail";
                                                                  END;
                                                                  "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
                                                                  "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
                                                                  "Tax Area Code" := Cust."Tax Area Code";
                                                                  "Tax Liable" := Cust."Tax Liable";
                                                                  "VAT Registration No." := Cust."VAT Registration No.";
                                                                  "Shipping Advice" := Cust."Shipping Advice";
                                                                  "Responsibility Center" := UserSetupMgt.GetRespCenter(2,Cust."Responsibility Center");
                                                                  VALIDATE("Location Code",UserSetupMgt.GetLocation(2,Cust."Location Code","Responsibility Center"));
                                                                END;

                                                                IF "Customer No." = xRec."Customer No." THEN
                                                                  IF ShippedServLinesExist THEN BEGIN
                                                                    TESTFIELD("VAT Bus. Posting Group",xRec."VAT Bus. Posting Group");
                                                                    TESTFIELD("Gen. Bus. Posting Group",xRec."Gen. Bus. Posting Group");
                                                                  END;

                                                                COMMIT;
                                                                IF Cust."Bill-to Customer No." <> '' THEN
                                                                  VALIDATE("Bill-to Customer No.",Cust."Bill-to Customer No.")
                                                                ELSE BEGIN
                                                                  IF "Bill-to Customer No." = "Customer No." THEN
                                                                    SkipBillToContact := TRUE;
                                                                  VALIDATE("Bill-to Customer No.","Customer No.");
                                                                  SkipBillToContact := FALSE;
                                                                END;

                                                                VALIDATE("Ship-to Code",'');
                                                                VALIDATE("Service Zone Code");

                                                                IF NOT SkipContact THEN
                                                                  UpdateCont("Customer No.");
                                                              END;

                                                   CaptionML=[ENU=Customer No.;
                                                              FRA=Nø client] }
    { 3   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  ServSetup.GET;
                                                                  TestNoSeriesManual;
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              FRA=Nø] }
    { 4   ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF (xRec."Bill-to Customer No." <> "Bill-to Customer No.") AND
                                                                   (xRec."Bill-to Customer No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text005,FALSE,FIELDCAPTION("Bill-to Customer No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      ServLine.SETFILTER("Quantity Shipped",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::Invoice THEN
                                                                        ServLine.SETFILTER("Shipment No.",'<>%1','');

                                                                    IF ServLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        ServLine.TESTFIELD("Quantity Shipped",0)
                                                                      ELSE
                                                                        ServLine.TESTFIELD("Shipment No.",'');
                                                                    ServLine.RESET
                                                                  END ELSE
                                                                    "Bill-to Customer No." := xRec."Bill-to Customer No.";
                                                                END;

                                                                GetCust("Bill-to Customer No.");
                                                                Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);
                                                                Cust.TESTFIELD("Customer Posting Group");

                                                                IF GUIALLOWED AND NOT HideValidationDialog AND
                                                                   ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order,"Document Type"::Invoice])
                                                                THEN
                                                                  CustCheckCreditLimit.ServiceHeaderCheck(Rec);

                                                                "Bill-to Name" := Cust.Name;
                                                                "Bill-to Name 2" := Cust."Name 2";
                                                                "Bill-to Address" := Cust.Address;
                                                                "Bill-to Address 2" := Cust."Address 2";
                                                                "Bill-to City" := Cust.City;
                                                                "Bill-to Post Code" := Cust."Post Code";
                                                                "Bill-to County" := Cust.County;
                                                                "Bill-to Country/Region Code" := Cust."Country/Region Code";
                                                                IF NOT SkipBillToContact THEN
                                                                  "Bill-to Contact" := Cust.Contact;
                                                                "Payment Terms Code" := Cust."Payment Terms Code";

                                                                IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                                                                  "Payment Method Code" := '';
                                                                  IF PaymentTerms.GET("Payment Terms Code") THEN
                                                                    IF PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN
                                                                      "Payment Method Code" := Cust."Payment Method Code"
                                                                END ELSE
                                                                  "Payment Method Code" := Cust."Payment Method Code";
                                                                GLSetup.GET;
                                                                IF GLSetup."Bill-to/Sell-to VAT Calc." = GLSetup."Bill-to/Sell-to VAT Calc."::"Bill-to/Pay-to No." THEN BEGIN
                                                                  "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
                                                                  "VAT Registration No." := Cust."VAT Registration No.";
                                                                  "VAT Country/Region Code" := Cust."Country/Region Code";
                                                                  "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
                                                                END;
                                                                "Customer Posting Group" := Cust."Customer Posting Group";
                                                                "Currency Code" := Cust."Currency Code";
                                                                "Customer Price Group" := Cust."Customer Price Group";
                                                                "Prices Including VAT" := Cust."Prices Including VAT";
                                                                "Allow Line Disc." := Cust."Allow Line Disc.";
                                                                "Invoice Disc. Code" := Cust."Invoice Disc. Code";
                                                                "Customer Disc. Group" := Cust."Customer Disc. Group";
                                                                "Language Code" := Cust."Language Code";
                                                                "Salesperson Code" := Cust."Salesperson Code";
                                                                Reserve := Cust.Reserve;
                                                                ValidateServPriceGrOnServItem;

                                                                IF "Bill-to Customer No." = xRec."Bill-to Customer No." THEN
                                                                  IF ShippedServLinesExist THEN BEGIN
                                                                    TESTFIELD("Customer Disc. Group",xRec."Customer Disc. Group");
                                                                    TESTFIELD("Currency Code",xRec."Currency Code");
                                                                  END;

                                                                CreateDim(
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Service Contract Header","Contract No.");

                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Payment Method Code");
                                                                VALIDATE("Currency Code");

                                                                IF (xRec."Customer No." = "Customer No.") AND
                                                                   (xRec."Bill-to Customer No." <> "Bill-to Customer No.")
                                                                THEN
                                                                  RecreateServLines(FIELDCAPTION("Bill-to Customer No."));

                                                                IF NOT SkipBillToContact THEN
                                                                  UpdateBillToCont("Bill-to Customer No.");
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              FRA=Nø client factur‚];
                                                   NotBlank=Yes }
    { 5   ;   ;Bill-to Name        ;Text50        ;CaptionML=[ENU=Bill-to Name;
                                                              FRA=Nom client factur‚] }
    { 6   ;   ;Bill-to Name 2      ;Text50        ;CaptionML=[ENU=Bill-to Name 2;
                                                              FRA=Nom client factur‚ 2] }
    { 7   ;   ;Bill-to Address     ;Text50        ;CaptionML=[ENU=Bill-to Address;
                                                              FRA=Adresse facturation] }
    { 8   ;   ;Bill-to Address 2   ;Text50        ;CaptionML=[ENU=Bill-to Address 2;
                                                              FRA=Adresse facturation 2] }
    { 9   ;   ;Bill-to City        ;Text30        ;TableRelation=IF (Bill-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Bill-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Bill-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Bill-to City;
                                                              FRA=Ville facturation] }
    { 10  ;   ;Bill-to Contact     ;Text50        ;CaptionML=[ENU=Bill-to Contact;
                                                              FRA=Contact facturation] }
    { 11  ;   ;Your Reference      ;Text35        ;CaptionML=[ENU=Your Reference;
                                                              FRA=Votre r‚f‚rence] }
    { 12  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Customer No.));
                                                   OnValidate=BEGIN
                                                                IF ("Ship-to Code" <> xRec."Ship-to Code") AND
                                                                   ("Customer No." = xRec."Customer No.")
                                                                THEN BEGIN
                                                                  IF ("Contract No." <> '') AND NOT HideValidationDialog THEN
                                                                    ERROR(
                                                                      Text003,
                                                                      FIELDCAPTION("Ship-to Code"),
                                                                      "Document Type",FIELDCAPTION("No."),"No.",
                                                                      FIELDCAPTION("Contract No."),"Contract No.");
                                                                  IF ServItemLineExists THEN BEGIN
                                                                    IF NOT
                                                                       CONFIRM(
                                                                         Text004,
                                                                         FALSE,FIELDCAPTION("Ship-to Code"))
                                                                    THEN BEGIN
                                                                      "Ship-to Code" := xRec."Ship-to Code";
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE
                                                                    IF ServLineExists THEN
                                                                      IF NOT
                                                                         CONFIRM(
                                                                           Text057,
                                                                           FALSE,FIELDCAPTION("Ship-to Code"))
                                                                      THEN BEGIN
                                                                        "Ship-to Code" := xRec."Ship-to Code";
                                                                        EXIT;
                                                                      END;
                                                                END;

                                                                IF "Document Type" <> "Document Type"::"Credit Memo" THEN
                                                                  IF "Ship-to Code" <> '' THEN BEGIN
                                                                    IF xRec."Ship-to Code" <> '' THEN BEGIN
                                                                      GetCust("Customer No.");
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        "Location Code" := Cust."Location Code";
                                                                      "Tax Area Code" := Cust."Tax Area Code";
                                                                    END;
                                                                    ShiptoAddr.GET("Customer No.","Ship-to Code");
                                                                    "Ship-to Name" := ShiptoAddr.Name;
                                                                    "Ship-to Name 2" := ShiptoAddr."Name 2";
                                                                    "Ship-to Address" := ShiptoAddr.Address;
                                                                    "Ship-to Address 2" := ShiptoAddr."Address 2";
                                                                    "Ship-to City" := ShiptoAddr.City;
                                                                    "Ship-to Post Code" := ShiptoAddr."Post Code";
                                                                    "Ship-to County" := ShiptoAddr.County;
                                                                    VALIDATE("Ship-to Country/Region Code",ShiptoAddr."Country/Region Code");
                                                                    "Ship-to Contact" := ShiptoAddr.Contact;
                                                                    "Ship-to Phone" := ShiptoAddr."Phone No.";
                                                                    IF ShiptoAddr."Location Code" <> '' THEN
                                                                      "Location Code" := ShiptoAddr."Location Code";
                                                                    "Ship-to Fax No." := ShiptoAddr."Fax No.";
                                                                    "Ship-to E-Mail" := ShiptoAddr."E-Mail";
                                                                    IF ShiptoAddr."Tax Area Code" <> '' THEN
                                                                      "Tax Area Code" := ShiptoAddr."Tax Area Code";
                                                                    "Tax Liable" := ShiptoAddr."Tax Liable";
                                                                  END ELSE
                                                                    IF "Customer No." <> '' THEN BEGIN
                                                                      GetCust("Customer No.");
                                                                      "Ship-to Name" := Cust.Name;
                                                                      "Ship-to Name 2" := Cust."Name 2";
                                                                      "Ship-to Address" := Cust.Address;
                                                                      "Ship-to Address 2" := Cust."Address 2";
                                                                      "Ship-to City" := Cust.City;
                                                                      "Ship-to Post Code" := Cust."Post Code";
                                                                      "Ship-to County" := Cust.County;
                                                                      VALIDATE("Ship-to Country/Region Code",Cust."Country/Region Code");
                                                                      "Ship-to Contact" := Cust.Contact;
                                                                      "Ship-to Phone" := Cust."Phone No.";
                                                                      "Tax Area Code" := Cust."Tax Area Code";
                                                                      "Tax Liable" := Cust."Tax Liable";
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        "Location Code" := Cust."Location Code";
                                                                      "Ship-to Fax No." := Cust."Fax No.";
                                                                      "Ship-to E-Mail" := Cust."E-Mail";
                                                                    END;

                                                                IF (xRec."Customer No." = "Customer No.") AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN
                                                                  IF (xRec."VAT Country/Region Code" <> "VAT Country/Region Code") OR
                                                                     (xRec."Tax Area Code" <> "Tax Area Code")
                                                                  THEN
                                                                    RecreateServLines(FIELDCAPTION("Ship-to Code"))
                                                                  ELSE BEGIN
                                                                    IF xRec."Tax Liable" <> "Tax Liable" THEN
                                                                      VALIDATE("Tax Liable");
                                                                  END;

                                                                VALIDATE("Service Zone Code");

                                                                IF ("Ship-to Code" <> xRec."Ship-to Code") AND
                                                                   ("Customer No." = xRec."Customer No.")
                                                                THEN BEGIN
                                                                  MODIFY(TRUE);
                                                                  ServLine.LOCKTABLE;
                                                                  ServItemLine.LOCKTABLE;
                                                                  ServLine.RESET;
                                                                  ServLine.SETRANGE("Document Type","Document Type");
                                                                  ServLine.SETRANGE("Document No.","No.");
                                                                  ServLine.DELETEALL(TRUE);
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.DELETEALL(TRUE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Ship-to Code;
                                                              FRA=Code destinataire] }
    { 13  ;   ;Ship-to Name        ;Text50        ;CaptionML=[ENU=Ship-to Name;
                                                              FRA=Nom du destinataire] }
    { 14  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[ENU=Ship-to Name 2;
                                                              FRA=Nom du destinataire 2] }
    { 15  ;   ;Ship-to Address     ;Text50        ;CaptionML=[ENU=Ship-to Address;
                                                              FRA=Adresse destinataire] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[ENU=Ship-to Address 2;
                                                              FRA=Adresse destinataire 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to City;
                                                              FRA=Ville destinataire] }
    { 18  ;   ;Ship-to Contact     ;Text50        ;CaptionML=[ENU=Ship-to Contact;
                                                              FRA=Contact destinataire] }
    { 19  ;   ;Order Date          ;Date          ;OnValidate=BEGIN
                                                                IF "Order Date" <> xRec."Order Date" THEN BEGIN
                                                                  IF ("Order Date" > "Starting Date") AND
                                                                     ("Starting Date" <> 0D)
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Order Date"),FIELDCAPTION("Starting Date"));

                                                                  IF ("Order Date" > "Finishing Date") AND
                                                                     ("Finishing Date" <> 0D)
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Order Date"),FIELDCAPTION("Finishing Date"));

                                                                  IF "Starting Time" <> 0T THEN
                                                                    VALIDATE("Starting Time");
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Starting Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Starting Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      IF ServItemLine."Starting Date" < "Order Date" THEN
                                                                        ERROR(
                                                                          Text027,FIELDCAPTION("Order Date"),
                                                                          ServItemLine.FIELDCAPTION("Starting Date"));
                                                                    UNTIL ServItemLine.NEXT = 0;

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      ServItemLine.CheckWarranty("Order Date");
                                                                      ServItemLine.CalculateResponseDateTime("Order Date","Order Time");
                                                                      ServItemLine.MODIFY;
                                                                    UNTIL ServItemLine.NEXT = 0;
                                                                  UpdateServLines(FIELDCAPTION("Order Date"),FALSE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order Date;
                                                              FRA=Date commande];
                                                   NotBlank=Yes }
    { 20  ;   ;Posting Date        ;Date          ;OnValidate=VAR
                                                                NoSeries@1000 : Record 308;
                                                              BEGIN
                                                                IF ("Posting No." <> '') AND ("Posting No. Series" <> '') THEN BEGIN
                                                                  NoSeries.GET("Posting No. Series");
                                                                  IF NoSeries."Date Order" THEN
                                                                    ERROR(
                                                                      Text045,
                                                                      FIELDCAPTION("Posting Date"),FIELDCAPTION("Posting No. Series"),"Posting No. Series",
                                                                      NoSeries.FIELDCAPTION("Date Order"),NoSeries."Date Order","Document Type",
                                                                      FIELDCAPTION("Posting No."),"Posting No.");
                                                                END;

                                                                VALIDATE("Document Date","Posting Date");

                                                                ServLine.SETRANGE("Document Type","Document Type");
                                                                ServLine.SETRANGE("Document No.","No.");
                                                                IF ServLine.FINDSET THEN
                                                                  REPEAT
                                                                    IF "Posting Date" <> ServLine."Posting Date" THEN BEGIN
                                                                      ServLine."Posting Date" := "Posting Date";
                                                                      ServLine.MODIFY;
                                                                    END;
                                                                  UNTIL ServLine.NEXT = 0;

                                                                IF ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"]) AND
                                                                   NOT ("Posting Date" = xRec."Posting Date")
                                                                THEN BEGIN
                                                                  IF ServLineExists THEN
                                                                    ServLine.MODIFYALL("Posting Date","Posting Date");
                                                                END;

                                                                IF "Currency Code" <> '' THEN BEGIN
                                                                  UpdateCurrencyFactor;
                                                                  IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                    ConfirmUpdateCurrencyFactor;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Posting Date;
                                                              FRA=Date comptabilisation] }
    { 22  ;   ;Posting Description ;Text50        ;CaptionML=[ENU=Posting Description;
                                                              FRA=Libell‚ ‚criture] }
    { 23  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   OnValidate=BEGIN
                                                                IF ("Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Payment Terms Code");
                                                                  IF ("Document Type" IN ["Document Type"::"Credit Memo"]) AND
                                                                     NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos"
                                                                  THEN BEGIN
                                                                    VALIDATE("Due Date","Document Date");
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    VALIDATE("Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Due Date","Document Date");
                                                                  VALIDATE("Pmt. Discount Date",0D);
                                                                  VALIDATE("Payment Discount %",0);
                                                                END;
                                                                UpdatePmtDiscDate;
                                                              END;

                                                   CaptionML=[ENU=Payment Terms Code;
                                                              FRA=Code conditions paiement] }
    { 24  ;   ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              FRA=Date d'‚ch‚ance] }
    { 25  ;   ;Payment Discount %  ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                                UpdatePmtDiscDate;
                                                              END;

                                                   CaptionML=[ENU=Payment Discount %;
                                                              FRA=% escompte];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 26  ;   ;Pmt. Discount Date  ;Date          ;OnValidate=BEGIN
                                                                UpdatePmtDiscDate;
                                                              END;

                                                   CaptionML=[ENU=Pmt. Discount Date;
                                                              FRA=Date d'escompte] }
    { 27  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Release Status","Release Status"::Open);
                                                              END;

                                                   CaptionML=[ENU=Shipment Method Code;
                                                              FRA=Code condition livraison] }
    { 28  ;   ;Location Code       ;Code10        ;TableRelation=Location;
                                                   OnValidate=BEGIN
                                                                IF ("Location Code" <> xRec."Location Code") AND
                                                                   ("Customer No." = xRec."Customer No.")
                                                                THEN
                                                                  MessageIfServLinesExist(FIELDCAPTION("Location Code"));

                                                                UpdateShipToAddress;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              FRA=Code magasin] }
    { 29  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                CheckHeaderDimension;
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              FRA=Code raccourci axe 1];
                                                   CaptionClass='1,2,1' }
    { 30  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                CheckHeaderDimension;
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              FRA=Code raccourci axe 2];
                                                   CaptionClass='1,2,2' }
    { 31  ;   ;Customer Posting Group;Code10      ;TableRelation="Customer Posting Group";
                                                   CaptionML=[ENU=Customer Posting Group;
                                                              FRA=Groupe compta. client];
                                                   Editable=No }
    { 32  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                IF CurrFieldNo <> FIELDNO("Currency Code") THEN
                                                                  UpdateCurrencyFactor
                                                                ELSE
                                                                  IF "Currency Code" <> xRec."Currency Code" THEN BEGIN
                                                                    IF ServLineExists AND ("Contract No." <> '') AND
                                                                       ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"])
                                                                    THEN
                                                                      ERROR(Text058,FIELDCAPTION("Currency Code"),"Document Type","No.","Contract No.");

                                                                    UpdateCurrencyFactor;
                                                                    ValidateServPriceGrOnServItem;
                                                                    RecreateServLines(FIELDCAPTION("Currency Code"));
                                                                  END ELSE
                                                                    IF "Currency Code" <> '' THEN BEGIN
                                                                      UpdateCurrencyFactor;
                                                                      IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                        ConfirmUpdateCurrencyFactor;
                                                                    END;
                                                              END;

                                                   CaptionML=[ENU=Currency Code;
                                                              FRA=Code devise] }
    { 33  ;   ;Currency Factor     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                  UpdateServLines(FIELDCAPTION("Currency Factor"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Currency Factor;
                                                              FRA=Facteur devise];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0;
                                                   Editable=No }
    { 34  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   OnValidate=BEGIN
                                                                PriceMsgIfServLinesExist(FIELDCAPTION("Customer Price Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Price Group;
                                                              FRA=Groupe prix client] }
    { 35  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                ServLine@1002 : Record 5902;
                                                                Currency@1001 : Record 4;
                                                                RecalculatePrice@1000 : Boolean;
                                                              BEGIN
                                                                IF "Prices Including VAT" <> xRec."Prices Including VAT" THEN BEGIN
                                                                  TESTFIELD("Max. Labor Unit Price",0);
                                                                  ServLine.SETRANGE("Document Type","Document Type");
                                                                  ServLine.SETRANGE("Document No.","No.");
                                                                  ServLine.SETFILTER(Type,'>0');
                                                                  ServLine.SETFILTER(Quantity,'<>0');
                                                                  IF ServLine.FIND('-') THEN
                                                                    REPEAT
                                                                      ServLine.Amount := 0;
                                                                      ServLine."Amount Including VAT" := 0;
                                                                      ServLine."VAT Base Amount" := 0;
                                                                      ServLine.InitOutstandingAmount;
                                                                      ServLine.MODIFY;
                                                                    UNTIL ServLine.NEXT = 0;
                                                                  ServLine.SETRANGE(Type);
                                                                  ServLine.SETRANGE(Quantity);

                                                                  ServLine.SETFILTER("Unit Price",'<>%1',0);
                                                                  ServLine.SETFILTER("VAT %",'<>%1',0);
                                                                  IF ServLine.FIND('-') THEN BEGIN
                                                                    RecalculatePrice :=
                                                                      CONFIRM(
                                                                        STRSUBSTNO(
                                                                          Text055,
                                                                          FIELDCAPTION("Prices Including VAT"),ServLine.FIELDCAPTION("Unit Price")),
                                                                        TRUE);
                                                                    ServLine.SetServHeader(Rec);

                                                                    IF "Currency Code" = '' THEN
                                                                      Currency.InitRoundingPrecision
                                                                    ELSE
                                                                      Currency.GET("Currency Code");

                                                                    REPEAT
                                                                      ServLine.TESTFIELD("Quantity Invoiced",0);
                                                                      IF NOT RecalculatePrice THEN BEGIN
                                                                        ServLine."VAT Difference" := 0;
                                                                        ServLine.InitOutstandingAmount;
                                                                      END ELSE
                                                                        IF "Prices Including VAT" THEN BEGIN
                                                                          ServLine."Unit Price" :=
                                                                            ROUND(
                                                                              ServLine."Unit Price" * (1 + (ServLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF ServLine.Quantity <> 0 THEN BEGIN
                                                                            ServLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                ServLine.CalcChargeableQty * ServLine."Unit Price" * ServLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            ServLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                ServLine."Inv. Discount Amount" * (1 + (ServLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END ELSE BEGIN
                                                                          ServLine."Unit Price" :=
                                                                            ROUND(
                                                                              ServLine."Unit Price" / (1 + (ServLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF ServLine.Quantity <> 0 THEN BEGIN
                                                                            ServLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                ServLine.CalcChargeableQty * ServLine."Unit Price" * ServLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            ServLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                ServLine."Inv. Discount Amount" / (1 + (ServLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END;
                                                                      ServLine.MODIFY;
                                                                    UNTIL ServLine.NEXT = 0;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prices Including VAT;
                                                              FRA=Prix TTC] }
    { 37  ;   ;Invoice Disc. Code  ;Code20        ;OnLookup=BEGIN
                                                              MessageIfServLinesExist(FIELDCAPTION("Invoice Disc. Code"));
                                                            END;

                                                   CaptionML=[ENU=Invoice Disc. Code;
                                                              FRA=Code remise facture] }
    { 40  ;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Customer Disc. Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Disc. Group;
                                                              FRA=Groupe rem. client] }
    { 41  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Language Code"));
                                                              END;

                                                   CaptionML=[ENU=Language Code;
                                                              FRA=Code langue] }
    { 43  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                CreateDim(
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::"Service Contract Header","Contract No.");
                                                              END;

                                                   CaptionML=[ENU=Salesperson Code;
                                                              FRA=Code vendeur] }
    { 46  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Comment Line" WHERE (Table Name=CONST(Service Header),
                                                                                                   Table Subtype=FIELD(Document Type),
                                                                                                   No.=FIELD(No.),
                                                                                                   Type=CONST(General)));
                                                   CaptionML=[ENU=Comment;
                                                              FRA=Commentaires];
                                                   Editable=No }
    { 47  ;   ;No. Printed         ;Integer       ;CaptionML=[ENU=No. Printed;
                                                              FRA=Nbre impressions];
                                                   Editable=No }
    { 52  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[ENU=Applies-to Doc. Type;
                                                              FRA=Type doc. lettrage];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    FRA=" ,Paiement,Facture,Avoir,Int‚rˆts,Relance,Remboursement"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 53  ;   ;Applies-to Doc. No. ;Code20        ;OnValidate=BEGIN
                                                                IF "Applies-to Doc. No." <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');

                                                                IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." <> '') AND
                                                                   ("Applies-to Doc. No." <> '')
                                                                THEN BEGIN
                                                                  SetAmountToApply("Applies-to Doc. No.","Customer No.");
                                                                  SetAmountToApply(xRec."Applies-to Doc. No.","Customer No.");
                                                                END ELSE
                                                                  IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." = '') THEN
                                                                    SetAmountToApply("Applies-to Doc. No.","Customer No.")
                                                                  ELSE
                                                                    IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND ("Applies-to Doc. No." = '') THEN
                                                                      SetAmountToApply(xRec."Applies-to Doc. No.","Customer No.");
                                                              END;

                                                   OnLookup=VAR
                                                              ApplyCustEntries@1000 : Page 232;
                                                            BEGIN
                                                              TESTFIELD("Bal. Account No.",'');
                                                              CustLedgEntry.SETCURRENTKEY("Customer No.",Open,Positive,"Due Date");
                                                              CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                              CustLedgEntry.SETRANGE(Open,TRUE);
                                                              IF "Applies-to Doc. No." <> '' THEN BEGIN
                                                                CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                                                IF CustLedgEntry.FINDFIRST THEN;
                                                                CustLedgEntry.SETRANGE("Document Type");
                                                                CustLedgEntry.SETRANGE("Document No.");
                                                              END ELSE
                                                                IF "Applies-to Doc. Type" <> 0 THEN BEGIN
                                                                  CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                  IF CustLedgEntry.FINDFIRST THEN
                                                                    CustLedgEntry.SETRANGE("Document Type");
                                                                END;

                                                              ApplyCustEntries.SetService(Rec,CustLedgEntry,ServHeader.FIELDNO("Applies-to Doc. No."));
                                                              ApplyCustEntries.SETTABLEVIEW(CustLedgEntry);
                                                              ApplyCustEntries.SETRECORD(CustLedgEntry);
                                                              ApplyCustEntries.LOOKUPMODE(TRUE);
                                                              IF ApplyCustEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ApplyCustEntries.GetCustLedgEntry(CustLedgEntry);
                                                                GenJnlApply.CheckAgainstApplnCurrency(
                                                                  "Currency Code",CustLedgEntry."Currency Code",GenJnlLine."Account Type"::Customer,TRUE);
                                                                "Applies-to Doc. Type" := CustLedgEntry."Document Type";
                                                                "Applies-to Doc. No." := CustLedgEntry."Document No.";
                                                              END;
                                                              CLEAR(ApplyCustEntries);
                                                            END;

                                                   CaptionML=[ENU=Applies-to Doc. No.;
                                                              FRA=Nø doc. lettrage] }
    { 55  ;   ;Bal. Account No.    ;Code20        ;TableRelation=IF (Bal. Account Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Bal. Account Type=CONST(Bank Account)) "Bank Account";
                                                   OnValidate=BEGIN
                                                                IF "Bal. Account No." <> '' THEN
                                                                  CASE "Bal. Account Type" OF
                                                                    "Bal. Account Type"::"G/L Account":
                                                                      BEGIN
                                                                        GLAcc.GET("Bal. Account No.");
                                                                        GLAcc.CheckGLAcc;
                                                                        GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                      END;
                                                                    "Bal. Account Type"::"Bank Account":
                                                                      BEGIN
                                                                        BankAcc.GET("Bal. Account No.");
                                                                        BankAcc.TESTFIELD(Blocked,FALSE);
                                                                        BankAcc.TESTFIELD("Currency Code","Currency Code");
                                                                      END;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Bal. Account No.;
                                                              FRA=Nø compte contrepartie] }
    { 62  ;   ;Shipping No.        ;Code20        ;CaptionML=[ENU=Shipping No.;
                                                              FRA=Utiliser B.L. Nø] }
    { 63  ;   ;Posting No.         ;Code20        ;CaptionML=[ENU=Posting No.;
                                                              FRA=Nø validation] }
    { 64  ;   ;Last Shipping No.   ;Code20        ;TableRelation="Service Shipment Header";
                                                   CaptionML=[ENU=Last Shipping No.;
                                                              FRA=Nø dern. bon de livraison];
                                                   Editable=No }
    { 65  ;   ;Last Posting No.    ;Code20        ;TableRelation="Service Invoice Header";
                                                   CaptionML=[ENU=Last Posting No.;
                                                              FRA=Nø dern. facture];
                                                   Editable=No }
    { 70  ;   ;VAT Registration No.;Text20        ;CaptionML=[ENU=VAT Registration No.;
                                                              FRA=Nø identif. intracomm.] }
    { 73  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              FRA=Code motif] }
    { 74  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF "Gen. Bus. Posting Group" <> xRec."Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN BEGIN
                                                                    "VAT Bus. Posting Group" := GenBusPostingGrp."Def. VAT Bus. Posting Group";
                                                                    RecreateServLines(FIELDCAPTION("Gen. Bus. Posting Group"));
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              FRA=Groupe compta. march‚] }
    { 75  ;   ;EU 3-Party Trade    ;Boolean       ;CaptionML=[ENU=EU 3-Party Trade;
                                                              FRA=Trans. tripartite UE] }
    { 76  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   OnValidate=BEGIN
                                                                UpdateServLines(FIELDCAPTION("Transaction Type"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Type;
                                                              FRA=Nature transaction] }
    { 77  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   OnValidate=BEGIN
                                                                UpdateServLines(FIELDCAPTION("Transport Method"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transport Method;
                                                              FRA=Mode de transport] }
    { 78  ;   ;VAT Country/Region Code;Code10     ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=VAT Country/Region Code;
                                                              FRA=Code pays/r‚gion TVA] }
    { 79  ;   ;Name                ;Text50        ;CaptionML=[ENU=Name;
                                                              FRA=Nom] }
    { 80  ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              FRA=Nom 2] }
    { 81  ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              FRA=Adresse] }
    { 82  ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              FRA=Adresse 2] }
    { 83  ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              FRA=Ville] }
    { 84  ;   ;Contact Name        ;Text50        ;CaptionML=[ENU=Contact Name;
                                                              FRA=Nom contact] }
    { 85  ;   ;Bill-to Post Code   ;Code20        ;TableRelation=IF (Bill-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Bill-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Bill-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Bill-to Post Code;
                                                              FRA=Code postal facturation] }
    { 86  ;   ;Bill-to County      ;Text30        ;CaptionML=[ENU=Bill-to County;
                                                              FRA=R‚gion facturation] }
    { 87  ;   ;Bill-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Bill-to Country/Region Code;
                                                              FRA=Code pays/r‚gion facturation] }
    { 88  ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              FRA=Code postal] }
    { 89  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              FRA=R‚gion] }
    { 90  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Ship-to Country/Region Code");
                                                              END;

                                                   CaptionML=[ENU=Country/Region Code;
                                                              FRA=Code pays/r‚gion] }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to Post Code;
                                                              FRA=Code postal destinataire] }
    { 92  ;   ;Ship-to County      ;Text30        ;CaptionML=[ENU=Ship-to County;
                                                              FRA=R‚gion destinataire] }
    { 93  ;   ;Ship-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                IF "Ship-to Country/Region Code" <> '' THEN
                                                                  "VAT Country/Region Code" := "Ship-to Country/Region Code"
                                                                ELSE
                                                                  "VAT Country/Region Code" := "Country/Region Code"
                                                              END;

                                                   CaptionML=[ENU=Ship-to Country/Region Code;
                                                              FRA=Code pays/r‚gion destinataire] }
    { 94  ;   ;Bal. Account Type   ;Option        ;CaptionML=[ENU=Bal. Account Type;
                                                              FRA=Type compte contrepartie];
                                                   OptionCaptionML=[ENU=G/L Account,Bank Account;
                                                                    FRA=G‚n‚ral,Banque];
                                                   OptionString=G/L Account,Bank Account }
    { 97  ;   ;Exit Point          ;Code10        ;TableRelation="Entry/Exit Point";
                                                   OnValidate=BEGIN
                                                                UpdateServLines(FIELDCAPTION("Exit Point"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Exit Point;
                                                              FRA=Pays destination] }
    { 98  ;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              FRA=Correction] }
    { 99  ;   ;Document Date       ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Payment Terms Code");
                                                              END;

                                                   CaptionML=[ENU=Document Date;
                                                              FRA=Date document] }
    { 101 ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   OnValidate=BEGIN
                                                                UpdateServLines(FIELDCAPTION(Area),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Area;
                                                              FRA=D‚pt destination/provenance] }
    { 102 ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   OnValidate=BEGIN
                                                                UpdateServLines(FIELDCAPTION("Transaction Specification"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Specification;
                                                              FRA=R‚gime] }
    { 104 ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   OnValidate=BEGIN
                                                                PaymentMethod.INIT;
                                                                IF "Payment Method Code" <> '' THEN
                                                                  PaymentMethod.GET("Payment Method Code");
                                                                "Bal. Account Type" := PaymentMethod."Bal. Account Type";
                                                                "Bal. Account No." := PaymentMethod."Bal. Account No.";

                                                                IF "Bal. Account No." <> '' THEN BEGIN
                                                                  TESTFIELD("Applies-to Doc. No.",'');
                                                                  TESTFIELD("Applies-to ID",'');
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Payment Method Code;
                                                              FRA=Code mode de rŠglement] }
    { 105 ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Release Status","Release Status"::Open);
                                                                IF xRec."Shipping Agent Code" = "Shipping Agent Code" THEN
                                                                  EXIT;

                                                                "Shipping Agent Service Code" := '';
                                                                GetShippingTime(FIELDNO("Shipping Agent Code"));
                                                                UpdateServLines(FIELDCAPTION("Shipping Agent Code"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              FRA=Code transporteur] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              FRA=Souches de nø];
                                                   Editable=No }
    { 108 ;   ;Posting No. Series  ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Posting No. Series" <> '' THEN BEGIN
                                                                  ServSetup.GET;
                                                                  TestNoSeries;
                                                                  NoSeriesMgt.TestSeries(GetPostingNoSeriesCode,"Posting No. Series");
                                                                END;
                                                                TESTFIELD("Posting No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH ServHeader DO BEGIN
                                                                ServHeader := Rec;
                                                                ServSetup.GET;
                                                                TestNoSeries;
                                                                IF NoSeriesMgt.LookupSeries(GetPostingNoSeriesCode,"Posting No. Series") THEN
                                                                  VALIDATE("Posting No. Series");
                                                                Rec := ServHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Posting No. Series;
                                                              FRA=Souches de nø validation] }
    { 109 ;   ;Shipping No. Series ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Shipping No. Series" <> '' THEN BEGIN
                                                                  ServSetup.GET;
                                                                  ServSetup.TESTFIELD("Posted Service Shipment Nos.");
                                                                  NoSeriesMgt.TestSeries(ServSetup."Posted Service Shipment Nos.","Shipping No. Series");
                                                                END;
                                                                TESTFIELD("Shipping No.",'');
                                                              END;

                                                   CaptionML=[ENU=Shipping No. Series;
                                                              FRA=Souche de nø exp‚dition] }
    { 114 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Tax Area Code"));
                                                              END;

                                                   CaptionML=[ENU=Tax Area Code;
                                                              FRA=Code zone recouvrement] }
    { 115 ;   ;Tax Liable          ;Boolean       ;OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Tax Liable"));
                                                              END;

                                                   CaptionML=[ENU=Tax Liable;
                                                              FRA=Soumis … recouvrement] }
    { 116 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF "VAT Bus. Posting Group" <> xRec."VAT Bus. Posting Group" THEN
                                                                  RecreateServLines(FIELDCAPTION("VAT Bus. Posting Group"));
                                                              END;

                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              FRA=Groupe compta. march‚ TVA] }
    { 117 ;   ;Reserve             ;Option        ;CaptionML=[ENU=Reserve;
                                                              FRA=R‚server];
                                                   OptionCaptionML=[ENU=Never,Optional,Always;
                                                                    FRA=Jamais,Manuel,Toujours];
                                                   OptionString=Never,Optional,Always }
    { 118 ;   ;Applies-to ID       ;Code50        ;OnValidate=VAR
                                                                TempCustLedgEntry@1000 : Record 21;
                                                                CustEntrySetApplID@1001 : Codeunit 101;
                                                              BEGIN
                                                                IF "Applies-to ID" <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');
                                                                IF ("Applies-to ID" <> xRec."Applies-to ID") AND (xRec."Applies-to ID" <> '') THEN BEGIN
                                                                  CustLedgEntry.SETCURRENTKEY("Customer No.",Open);
                                                                  CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                                  CustLedgEntry.SETRANGE(Open,TRUE);
                                                                  CustLedgEntry.SETRANGE("Applies-to ID",xRec."Applies-to ID");
                                                                  IF CustLedgEntry.FINDFIRST THEN
                                                                    CustEntrySetApplID.SetApplId(CustLedgEntry,TempCustLedgEntry,'');
                                                                  CustLedgEntry.RESET;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Applies-to ID;
                                                              FRA=ID lettrage] }
    { 119 ;   ;VAT Base Discount % ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                IF "VAT Base Discount %" > GLSetup."VAT Tolerance %" THEN
                                                                  ERROR(
                                                                    Text011,
                                                                    FIELDCAPTION("VAT Base Discount %"),
                                                                    GLSetup.FIELDCAPTION("VAT Tolerance %"),
                                                                    GLSetup.TABLECAPTION);

                                                                IF ("VAT Base Discount %" = xRec."VAT Base Discount %") AND
                                                                   (CurrFieldNo <> 0)
                                                                THEN
                                                                  EXIT;

                                                                ServLine.RESET;
                                                                ServLine.SETRANGE("Document Type","Document Type");
                                                                ServLine.SETRANGE("Document No.","No.");
                                                                ServLine.SETFILTER(Type,'<>%1',ServLine.Type::" ");
                                                                ServLine.SETFILTER(Quantity,'<>0');
                                                                ServLine.LOCKTABLE;
                                                                LOCKTABLE;
                                                                IF ServLine.FINDSET THEN BEGIN
                                                                  MODIFY;
                                                                  REPEAT
                                                                    IF (ServLine."Quantity Invoiced" <> ServLine.Quantity) OR
                                                                       ("Shipping Advice" <> "Shipping Advice"::Partial) OR
                                                                       (CurrFieldNo <> 0)
                                                                    THEN BEGIN
                                                                      ServLine.UpdateAmounts;
                                                                      ServLine.MODIFY;
                                                                    END;
                                                                  UNTIL ServLine.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=VAT Base Discount %;
                                                              FRA=% remise base TVA];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 120 ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                ServItemLine.RESET;
                                                                ServItemLine.SETRANGE("Document Type","Document Type");
                                                                ServItemLine.SETRANGE("Document No.","No.");
                                                                IF ServItemLine.FIND('-') THEN
                                                                  REPEAT
                                                                    IF ServItemLine."Repair Status Code" <> '' THEN BEGIN
                                                                      RepairStatus.GET(ServItemLine."Repair Status Code");
                                                                      IF ((Status = Status::Pending) AND NOT RepairStatus."Pending Status Allowed") OR
                                                                         ((Status = Status::"In Process") AND NOT RepairStatus."In Process Status Allowed") OR
                                                                         ((Status = Status::Finished) AND NOT RepairStatus."Finished Status Allowed") OR
                                                                         ((Status = Status::"On Hold") AND NOT RepairStatus."On Hold Status Allowed")
                                                                      THEN
                                                                        ERROR(
                                                                          Text031,
                                                                          FIELDCAPTION(Status),FORMAT(Status),TABLECAPTION,"No.",ServItemLine.FIELDCAPTION("Repair Status Code"),
                                                                          ServItemLine."Repair Status Code",ServItemLine.TABLECAPTION,ServItemLine."Line No.")
                                                                    END;
                                                                  UNTIL ServItemLine.NEXT = 0;

                                                                LinesExist := ServItemLineExists;
                                                                CASE Status OF
                                                                  Status::"In Process":
                                                                    BEGIN
                                                                      IF NOT LinesExist THEN BEGIN
                                                                        "Starting Date" := WORKDATE;
                                                                        VALIDATE("Starting Time",TIME);
                                                                      END ELSE
                                                                        UpdateStartingDateTime;
                                                                    END;
                                                                  Status::Finished:
                                                                    BEGIN
                                                                      TestMandatoryFields(ServLine);
                                                                      IF Status <> xRec.Status THEN
                                                                        IF "Notify Customer" = "Notify Customer"::"By E-Mail" THEN BEGIN
                                                                          TESTFIELD("Customer No.");
                                                                          CLEAR(NotifyCust);
                                                                          NotifyCust.RUN(Rec);
                                                                        END;
                                                                      IF NOT LinesExist THEN BEGIN
                                                                        IF ("Finishing Date" = 0D) AND ("Finishing Time" = 0T) THEN BEGIN
                                                                          "Finishing Date" := WORKDATE;
                                                                          "Finishing Time" := TIME;
                                                                        END;
                                                                      END ELSE
                                                                        UpdateFinishingDateTime;
                                                                    END;
                                                                END;

                                                                IF Status <> Status::Finished THEN BEGIN
                                                                  "Finishing Date" := 0D;
                                                                  "Finishing Time" := 0T;
                                                                  "Service Time (Hours)" := 0;
                                                                END;

                                                                IF ("Starting Date" <> 0D) AND
                                                                   ("Finishing Date" <> 0D) AND
                                                                   NOT LinesExist
                                                                THEN BEGIN
                                                                  CALCFIELDS("Contract Serv. Hours Exist");
                                                                  "Service Time (Hours)" :=
                                                                    ServOrderMgt.CalcServTime(
                                                                      "Starting Date","Starting Time","Finishing Date","Finishing Time",
                                                                      "Contract No.","Contract Serv. Hours Exist");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              FRA=Statut];
                                                   OptionCaptionML=[ENU=Pending,In Process,Finished,On Hold;
                                                                    FRA=Suspendu,En cours,Termin‚,En attente];
                                                   OptionString=Pending,In Process,Finished,On Hold }
    { 121 ;   ;Invoice Discount Calculation;Option;CaptionML=[ENU=Invoice Discount Calculation;
                                                              FRA=Calcul remise facture];
                                                   OptionCaptionML=[ENU=None,%,Amount;
                                                                    FRA=Aucun,%,Montant];
                                                   OptionString=None,%,Amount;
                                                   Editable=No }
    { 122 ;   ;Invoice Discount Value;Decimal     ;CaptionML=[ENU=Invoice Discount Value;
                                                              FRA=Valeur remise facture];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 130 ;   ;Release Status      ;Option        ;CaptionML=[ENU=Release Status;
                                                              FRA=Statut de lancement];
                                                   OptionCaptionML=[ENU=Open,Released to Ship;
                                                                    FRA=Ouvert,Lancer pour exp‚dition];
                                                   OptionString=Open,Released to Ship;
                                                   Editable=No }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDocDim;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              FRA=ID ensemble de dimensions];
                                                   Editable=No }
    { 5052;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1000 : Record 5050;
                                                                ContBusinessRelation@1001 : Record 5054;
                                                              BEGIN
                                                                IF ("Contact No." <> xRec."Contact No.") AND
                                                                   (xRec."Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text005,FALSE,FIELDCAPTION("Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.RESET;
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF ("Contact No." = '') AND ("Customer No." = '') THEN BEGIN
                                                                      IF NOT ServLine.ISEMPTY THEN
                                                                        ERROR(Text050,FIELDCAPTION("Contact No."));
                                                                      INIT;
                                                                      ServSetup.GET;
                                                                      InitRecord;
                                                                      "No. Series" := xRec."No. Series";
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Customer No." <> '') AND ("Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST AND
                                                                     (ContBusinessRelation."Contact No." <> Cont."Company No.")
                                                                  THEN
                                                                    ERROR(Text038,Cont."No.",Cont.Name,"Customer No.");
                                                                END;

                                                                UpdateCust("Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1000 : Record 5050;
                                                              ContBusinessRelation@1001 : Record 5054;
                                                            BEGIN
                                                              IF "Customer No." <> '' THEN
                                                                IF Cont.GET("Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Contact No." <> '' THEN
                                                                IF Cont.GET("Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Contact No.;
                                                              FRA=Nø contact] }
    { 5053;   ;Bill-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1001 : Record 5050;
                                                                ContBusinessRelation@1000 : Record 5054;
                                                              BEGIN
                                                                IF ("Bill-to Contact No." <> xRec."Bill-to Contact No.") AND
                                                                   (xRec."Bill-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text005,FALSE,FIELDCAPTION("Bill-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.RESET;
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF ("Bill-to Contact No." = '') AND ("Bill-to Customer No." = '') THEN BEGIN
                                                                      IF NOT ServLine.ISEMPTY THEN
                                                                        ERROR(Text050,FIELDCAPTION("Bill-to Contact No."));
                                                                      INIT;
                                                                      ServSetup.GET;
                                                                      InitRecord;
                                                                      "No. Series" := xRec."No. Series";
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Bill-to Contact No." := xRec."Bill-to Contact No.";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Bill-to Customer No." <> '') AND ("Bill-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Bill-to Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Bill-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST AND
                                                                     (ContBusinessRelation."Contact No." <> Cont."Company No.")
                                                                  THEN
                                                                    ERROR(Text038,Cont."No.",Cont.Name,"Bill-to Customer No.");
                                                                END;

                                                                UpdateBillToCust("Bill-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Bill-to Customer No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Bill-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Bill-to Contact No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Bill-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Bill-to Contact No.;
                                                              FRA=Nø contact facturation] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   OnValidate=VAR
                                                                RespCenter@1000 : Record 5714;
                                                              BEGIN
                                                                IF NOT UserSetupMgt.CheckRespCenter(2,"Responsibility Center") THEN
                                                                  ERROR(
                                                                    Text010,
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetServiceFilter);

                                                                UpdateShipToAddress;

                                                                CreateDim(
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::"Service Contract Header","Contract No.");

                                                                ServItemLine.RESET;
                                                                ServItemLine.SETRANGE("Document Type","Document Type");
                                                                ServItemLine.SETRANGE("Document No.","No.");
                                                                IF ServItemLine.FIND('-') THEN
                                                                  REPEAT
                                                                    ServItemLine.VALIDATE("Responsibility Center","Responsibility Center");
                                                                    ServItemLine.MODIFY(TRUE);
                                                                  UNTIL ServItemLine.NEXT = 0;

                                                                IF xRec."Responsibility Center" <> "Responsibility Center" THEN BEGIN
                                                                  RecreateServLines(FIELDCAPTION("Responsibility Center"));
                                                                  VALIDATE("Location Code",UserSetupMgt.GetLocation(2,'',"Responsibility Center"));
                                                                  "Assigned User ID" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Responsibility Center;
                                                              FRA=Centre de gestion] }
    { 5750;   ;Shipping Advice     ;Option        ;OnValidate=VAR
                                                                WhseValidateSourceHeader@1000 : Codeunit 5781;
                                                              BEGIN
                                                                TESTFIELD("Release Status","Release Status"::Open);
                                                                IF InventoryPickConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(Text064,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION);
                                                                IF WhseShpmntConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(STRSUBSTNO(Text065,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION));
                                                                WhseValidateSourceHeader.ServiceHeaderVerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Shipping Advice;
                                                              FRA=Option d'exp‚dition];
                                                   OptionCaptionML=[ENU=Partial,Complete;
                                                                    FRA=Partielle,Totale];
                                                   OptionString=Partial,Complete }
    { 5752;   ;Completely Shipped  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Service Line"."Completely Shipped" WHERE (Document Type=FIELD(Document Type),
                                                                                                              Document No.=FIELD(No.),
                                                                                                              Type=FILTER(<>' '),
                                                                                                              Location Code=FIELD(Location Filter)));
                                                   CaptionML=[ENU=Completely Shipped;
                                                              FRA=EntiŠrement exp‚di‚e];
                                                   Editable=No }
    { 5754;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location.Code;
                                                   CaptionML=[ENU=Location Filter;
                                                              FRA=Filtre magasin] }
    { 5792;   ;Shipping Time       ;DateFormula   ;OnValidate=BEGIN
                                                                TESTFIELD("Release Status","Release Status"::Open);
                                                                IF "Shipping Time" <> xRec."Shipping Time" THEN
                                                                  UpdateServLines(FIELDCAPTION("Shipping Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Time;
                                                              FRA=D‚lai d'exp‚dition] }
    { 5794;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Release Status","Release Status"::Open);
                                                                GetShippingTime(FIELDNO("Shipping Agent Service Code"));
                                                                UpdateServLines(FIELDCAPTION("Shipping Agent Service Code"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Shipping Agent Service Code;
                                                              FRA=Code prestation transporteur] }
    { 5796;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              FRA=Filtre date] }
    { 5902;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              FRA=D‚signation] }
    { 5904;   ;Service Order Type  ;Code10        ;TableRelation="Service Order Type";
                                                   OnValidate=BEGIN
                                                                CreateDim(
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Service Contract Header","Contract No.");
                                                              END;

                                                   CaptionML=[ENU=Service Order Type;
                                                              FRA=Type commande service] }
    { 5905;   ;Link Service to Service Item;Boolean;
                                                   OnValidate=BEGIN
                                                                IF "Link Service to Service Item" <> xRec."Link Service to Service Item" THEN BEGIN
                                                                  ServLine.RESET;
                                                                  ServLine.SETRANGE("Document Type","Document Type");
                                                                  ServLine.SETRANGE("Document No.","No.");
                                                                  ServLine.SETFILTER(Type,'<>%1',ServLine.Type::Cost);
                                                                  IF ServLine.FIND('-') THEN
                                                                    MESSAGE(
                                                                      Text001,
                                                                      FIELDCAPTION("Link Service to Service Item"),
                                                                      "No.");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Link Service to Service Item;
                                                              FRA=Lier service … article de service] }
    { 5907;   ;Priority            ;Option        ;CaptionML=[ENU=Priority;
                                                              FRA=Priorit‚];
                                                   OptionCaptionML=[ENU=Low,Medium,High;
                                                                    FRA=Faible,Moyenne,Haute];
                                                   OptionString=Low,Medium,High;
                                                   Editable=No }
    { 5911;   ;Allocated Hours     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Allocation"."Allocated Hours" WHERE (Document Type=FIELD(Document Type),
                                                                                                                       Document No.=FIELD(No.),
                                                                                                                       Allocation Date=FIELD(Date Filter),
                                                                                                                       Resource No.=FIELD(Resource Filter),
                                                                                                                       Status=FILTER(Active|Finished),
                                                                                                                       Resource Group No.=FIELD(Resource Group Filter)));
                                                   CaptionML=[ENU=Allocated Hours;
                                                              FRA=Heures affect‚es];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5915;   ;Phone No.           ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              FRA=Nø t‚l‚phone] }
    { 5916;   ;E-Mail              ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail;
                                                              FRA=E-mail] }
    { 5917;   ;Phone No. 2         ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No. 2;
                                                              FRA=Nø t‚l‚phone 2] }
    { 5918;   ;Fax No.             ;Text30        ;CaptionML=[ENU=Fax No.;
                                                              FRA=Nø t‚l‚copie] }
    { 5921;   ;No. of Unallocated Items;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Item Line" WHERE (Document Type=FIELD(Document Type),
                                                                                                Document No.=FIELD(No.),
                                                                                                No. of Active/Finished Allocs=CONST(0)));
                                                   CaptionML=[ENU=No. of Unallocated Items;
                                                              FRA=Nbre articles non affect‚s];
                                                   Editable=No }
    { 5923;   ;Order Time          ;Time          ;OnValidate=BEGIN
                                                                IF "Order Time" <> xRec."Order Time" THEN BEGIN
                                                                  IF ("Order Time" > "Starting Time") AND
                                                                     ("Starting Time" <> 0T) AND
                                                                     ("Order Date" = "Starting Date")
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Order Time"),FIELDCAPTION("Starting Time"));
                                                                  IF "Starting Time" <> 0T THEN
                                                                    VALIDATE("Starting Time");
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      ServItemLine.CalculateResponseDateTime("Order Date","Order Time");
                                                                      ServItemLine.MODIFY;
                                                                    UNTIL ServItemLine.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order Time;
                                                              FRA=Heure commande];
                                                   NotBlank=Yes }
    { 5924;   ;Default Response Time (Hours);Decimal;
                                                   CaptionML=[ENU=Default Response Time (Hours);
                                                              FRA=D‚lai de r‚ponse par d‚f. (heures)];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 5925;   ;Actual Response Time (Hours);Decimal;
                                                   CaptionML=[ENU=Actual Response Time (Hours);
                                                              FRA=D‚lai de r‚ponse r‚el (heures)];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   Editable=No }
    { 5926;   ;Service Time (Hours);Decimal       ;CaptionML=[ENU=Service Time (Hours);
                                                              FRA=Temps de service (heures)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5927;   ;Response Date       ;Date          ;CaptionML=[ENU=Response Date;
                                                              FRA=Date de r‚ponse];
                                                   Editable=No }
    { 5928;   ;Response Time       ;Time          ;CaptionML=[ENU=Response Time;
                                                              FRA=D‚lai de r‚ponse];
                                                   Editable=No }
    { 5929;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                IF "Starting Date" <> 0D THEN BEGIN
                                                                  IF "Starting Date" < "Order Date" THEN
                                                                    ERROR(Text026,FIELDCAPTION("Starting Date"),FIELDCAPTION("Order Date"));

                                                                  IF ("Starting Date" > "Finishing Date") AND
                                                                     ("Finishing Date" <> 0D)
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Starting Date"),FIELDCAPTION("Finishing Time"));

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Starting Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Starting Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      IF ServItemLine."Starting Date" < "Starting Date" THEN
                                                                        ERROR(Text024,FIELDCAPTION("Starting Date"));
                                                                    UNTIL ServItemLine.NEXT = 0;

                                                                  IF TIME < "Order Time" THEN
                                                                    VALIDATE("Starting Time","Order Time")
                                                                  ELSE
                                                                    VALIDATE("Starting Time",TIME);
                                                                END ELSE BEGIN
                                                                  "Starting Time" := 0T;
                                                                  "Actual Response Time (Hours)" := 0;
                                                                  "Finishing Date" := 0D;
                                                                  "Finishing Time" := 0T;
                                                                  "Service Time (Hours)" := 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              FRA=Date d‚but] }
    { 5930;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                TESTFIELD("Starting Date");

                                                                IF ("Starting Date" = "Finishing Date") AND
                                                                   ("Starting Time" > "Finishing Time")
                                                                THEN
                                                                  ERROR(Text007,FIELDCAPTION("Starting Time"),FIELDCAPTION("Finishing Time"));

                                                                IF ("Starting Date" = "Order Date") AND
                                                                   ("Starting Time" < "Order Time")
                                                                THEN
                                                                  ERROR(Text026,FIELDCAPTION("Starting Time"),FIELDCAPTION("Order Time"));

                                                                IF ("Starting Time" = 0T) AND (xRec."Starting Time" <> 0T) THEN BEGIN
                                                                  "Finishing Time" := 0T;
                                                                  "Finishing Date" := 0D;
                                                                  "Service Time (Hours)" := 0;
                                                                END;

                                                                IF ("Starting Time" <> 0T) AND
                                                                   ("Starting Date" <> 0D)
                                                                THEN BEGIN
                                                                  CALCFIELDS("Contract Serv. Hours Exist");
                                                                  "Actual Response Time (Hours)" :=
                                                                    ServOrderMgt.CalcServTime(
                                                                      "Order Date","Order Time","Starting Date","Starting Time",
                                                                      "Contract No.","Contract Serv. Hours Exist");
                                                                END ELSE
                                                                  "Actual Response Time (Hours)" := 0;
                                                                IF "Finishing Time" <> 0T THEN
                                                                  VALIDATE("Finishing Time");
                                                              END;

                                                   CaptionML=[ENU=Starting Time;
                                                              FRA=Heure d‚but] }
    { 5931;   ;Finishing Date      ;Date          ;OnValidate=BEGIN
                                                                IF "Finishing Date" <> 0D THEN BEGIN
                                                                  IF "Finishing Date" < "Starting Date" THEN
                                                                    ERROR(Text026,FIELDCAPTION("Finishing Date"),FIELDCAPTION("Starting Date"));

                                                                  IF "Finishing Date" < "Order Date" THEN
                                                                    ERROR(
                                                                      Text026,
                                                                      FIELDCAPTION("Finishing Date"),
                                                                      FIELDCAPTION("Order Date"));

                                                                  IF "Starting Date" = 0D THEN BEGIN
                                                                    "Starting Date" := "Finishing Date";
                                                                    "Starting Time" := TIME;
                                                                    CALCFIELDS("Contract Serv. Hours Exist");
                                                                    "Actual Response Time (Hours)" :=
                                                                      ServOrderMgt.CalcServTime(
                                                                        "Order Date","Order Time","Starting Date","Starting Time",
                                                                        "Contract No.","Contract Serv. Hours Exist");
                                                                  END;

                                                                  IF "Finishing Date" <> xRec."Finishing Date" THEN BEGIN
                                                                    IF TIME < "Starting Time" THEN
                                                                      "Finishing Time" := "Starting Time"
                                                                    ELSE
                                                                      "Finishing Time" := TIME;
                                                                    VALIDATE("Finishing Time");
                                                                  END;

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Finishing Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Finishing Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      IF ServItemLine."Finishing Date" > "Finishing Date" THEN
                                                                        ERROR(Text025,FIELDCAPTION("Finishing Date"));
                                                                    UNTIL ServItemLine.NEXT = 0;
                                                                END ELSE BEGIN
                                                                  "Finishing Time" := 0T;
                                                                  "Service Time (Hours)" := 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Finishing Date;
                                                              FRA=Date fin] }
    { 5932;   ;Finishing Time      ;Time          ;OnValidate=BEGIN
                                                                TESTFIELD("Finishing Date");
                                                                IF "Finishing Time" <> 0T THEN BEGIN
                                                                  IF ("Starting Date" = "Finishing Date") AND
                                                                     ("Finishing Time" < "Starting Time")
                                                                  THEN
                                                                    ERROR(
                                                                      Text026,FIELDCAPTION("Finishing Time"),
                                                                      FIELDCAPTION("Starting Time"));

                                                                  IF ("Finishing Date" = "Order Date") AND
                                                                     ("Finishing Time" < "Order Time")
                                                                  THEN
                                                                    ERROR(
                                                                      Text026,FIELDCAPTION("Finishing Time"),
                                                                      FIELDCAPTION("Order Time"));

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Finishing Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Finishing Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      IF (ServItemLine."Finishing Date" = "Finishing Date") AND
                                                                         (ServItemLine."Finishing Time" > "Finishing Time")
                                                                      THEN
                                                                        ERROR(Text025,FIELDCAPTION("Finishing Time"));
                                                                    UNTIL ServItemLine.NEXT = 0;

                                                                  CALCFIELDS("Contract Serv. Hours Exist");
                                                                  "Service Time (Hours)" :=
                                                                    ServOrderMgt.CalcServTime(
                                                                      "Starting Date","Starting Time","Finishing Date","Finishing Time",
                                                                      "Contract No.","Contract Serv. Hours Exist");
                                                                END ELSE
                                                                  "Service Time (Hours)" := 0;
                                                              END;

                                                   CaptionML=[ENU=Finishing Time;
                                                              FRA=Heure fin] }
    { 5933;   ;Contract Serv. Hours Exist;Boolean ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Hour" WHERE (Service Contract No.=FIELD(Contract No.)));
                                                   CaptionML=[ENU=Contract Serv. Hours Exist;
                                                              FRA=Heures contrat de service d‚finies];
                                                   Editable=No }
    { 5934;   ;Reallocation Needed ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Order Allocation" WHERE (Status=CONST(Reallocation Needed),
                                                                                                       Resource No.=FIELD(Resource Filter),
                                                                                                       Document Type=FIELD(Document Type),
                                                                                                       Document No.=FIELD(No.),
                                                                                                       Resource Group No.=FIELD(Resource Group Filter)));
                                                   CaptionML=[ENU=Reallocation Needed;
                                                              FRA=R‚affectation n‚cessaire];
                                                   Editable=No }
    { 5936;   ;Notify Customer     ;Option        ;CaptionML=[ENU=Notify Customer;
                                                              FRA=Informer client];
                                                   OptionCaptionML=[ENU=No,By Phone 1,By Phone 2,By Fax,By E-Mail;
                                                                    FRA=Non,Par t‚l‚phone 1,Par t‚l‚phone 2,Par t‚l‚copie,Par e-mail];
                                                   OptionString=No,By Phone 1,By Phone 2,By Fax,By E-Mail }
    { 5937;   ;Max. Labor Unit Price;Decimal      ;OnValidate=BEGIN
                                                                IF ServLineExists THEN
                                                                  MESSAGE(
                                                                    Text001,
                                                                    FIELDCAPTION("Max. Labor Unit Price"),
                                                                    "No.");
                                                              END;

                                                   CaptionML=[ENU=Max. Labor Unit Price;
                                                              FRA=Prix unitaire max. M.O.];
                                                   BlankZero=Yes;
                                                   AutoFormatType=2;
                                                   AutoFormatExpr="Currency Code" }
    { 5938;   ;Warning Status      ;Option        ;CaptionML=[ENU=Warning Status;
                                                              FRA=Statut alerte];
                                                   OptionCaptionML=[ENU=" ,First Warning,Second Warning,Third Warning";
                                                                    FRA=" ,PremiŠre alerte,DeuxiŠme alerte,TroisiŠme alerte"];
                                                   OptionString=[ ,First Warning,Second Warning,Third Warning] }
    { 5939;   ;No. of Allocations  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Order Allocation" WHERE (Document Type=FIELD(Document Type),
                                                                                                       Document No.=FIELD(No.),
                                                                                                       Resource No.=FIELD(Resource Filter),
                                                                                                       Resource Group No.=FIELD(Resource Group Filter),
                                                                                                       Allocation Date=FIELD(Date Filter),
                                                                                                       Status=FILTER(Active|Finished)));
                                                   CaptionML=[ENU=No. of Allocations;
                                                              FRA=Nbre affectations];
                                                   Editable=No }
    { 5940;   ;Contract No.        ;Code20        ;TableRelation="Service Contract Header"."Contract No." WHERE (Contract Type=CONST(Contract),
                                                                                                                 Customer No.=FIELD(Customer No.),
                                                                                                                 Ship-to Code=FIELD(Ship-to Code),
                                                                                                                 Bill-to Customer No.=FIELD(Bill-to Customer No.));
                                                   OnValidate=BEGIN
                                                                IF "Contract No." <> xRec."Contract No." THEN BEGIN
                                                                  IF "Contract No." <> '' THEN BEGIN
                                                                    TESTFIELD("Order Date");
                                                                    ServContract.GET(ServContract."Contract Type"::Contract,"Contract No.");
                                                                    IF ServContract.Status <> ServContract.Status::Signed THEN
                                                                      ERROR(Text041,"Contract No.");
                                                                    IF ServContract."Starting Date" > "Order Date" THEN
                                                                      ERROR(Text042,"Contract No.");
                                                                    IF (ServContract."Expiration Date" <> 0D) AND
                                                                       (ServContract."Expiration Date" < "Order Date")
                                                                    THEN
                                                                      ERROR(Text043,"Contract No.");
                                                                  END;
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    ERROR(Text028,
                                                                      FIELDCAPTION("Contract No."),ServItemLine.TABLECAPTION);
                                                                  IF NOT
                                                                     CONFIRM(
                                                                       Text029,
                                                                       FALSE,ServContractLine.FIELDCAPTION("Next Planned Service Date"),
                                                                       ServContractLine.TABLECAPTION,
                                                                       FIELDCAPTION("Contract No."))
                                                                  THEN BEGIN
                                                                    "Contract No." := xRec."Contract No.";
                                                                    EXIT;
                                                                  END;

                                                                  IF "Contract No." <> '' THEN BEGIN
                                                                    TESTFIELD("Customer No.");
                                                                    TESTFIELD("Bill-to Customer No.");
                                                                    "Default Response Time (Hours)" := ServContract."Response Time (Hours)";
                                                                    TESTFIELD("Ship-to Code",ServContract."Ship-to Code");
                                                                    "Service Order Type" := ServContract."Service Order Type";
                                                                    VALIDATE("Currency Code",ServContract."Currency Code");
                                                                    "Max. Labor Unit Price" := ServContract."Max. Labor Unit Price";
                                                                    "Your Reference" := ServContract."Your Reference";
                                                                    "Service Zone Code" := ServContract."Service Zone Code";
                                                                  END;
                                                                END;

                                                                IF "Contract No." <> '' THEN
                                                                  CreateDim(
                                                                    DATABASE::"Service Contract Header","Contract No.",
                                                                    DATABASE::"Service Order Type","Service Order Type",
                                                                    DATABASE::Customer,"Bill-to Customer No.",
                                                                    DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                    DATABASE::"Responsibility Center","Responsibility Center");
                                                              END;

                                                   OnLookup=BEGIN
                                                              IF "Contract No." <> '' THEN BEGIN
                                                                IF ServContract.GET(ServContract."Contract Type"::Contract,"Contract No.") THEN
                                                                  ServContractList.SETRECORD(ServContract);
                                                              END;

                                                              ServContract.RESET;
                                                              ServContract.FILTERGROUP(2);
                                                              ServContract.SETCURRENTKEY("Customer No.","Ship-to Code");
                                                              ServContract.SETRANGE("Customer No.","Customer No.");
                                                              ServContract.SETRANGE("Ship-to Code","Ship-to Code");
                                                              ServContract.SETRANGE("Contract Type",ServContract."Contract Type"::Contract);
                                                              ServContract.SETRANGE("Bill-to Customer No.","Bill-to Customer No.");
                                                              ServContract.SETRANGE(Status,ServContract.Status::Signed);
                                                              ServContract.SETFILTER("Starting Date",'<=%1',"Order Date");
                                                              ServContract.SETFILTER("Expiration Date",'>=%1 | =%2',"Order Date",0D);
                                                              ServContract.FILTERGROUP(0);
                                                              CLEAR(ServContractList);
                                                              ServContractList.SETTABLEVIEW(ServContract);
                                                              ServContractList.LOOKUPMODE(TRUE);
                                                              IF ServContractList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ServContractList.GETRECORD(ServContract);
                                                                VALIDATE("Contract No.",ServContract."Contract No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Contract No.;
                                                              FRA=Nø contrat] }
    { 5951;   ;Type Filter         ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Type Filter;
                                                              FRA=Filtre type];
                                                   OptionCaptionML=[ENU=" ,Resource,Item,Service Cost,Service Contract";
                                                                    FRA=" ,Ressource,Article,Co–t service,Contrat de service"];
                                                   OptionString=[ ,Resource,Item,Service Cost,Service Contract] }
    { 5952;   ;Customer Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Customer.No.;
                                                   CaptionML=[ENU=Customer Filter;
                                                              FRA=Filtre client] }
    { 5953;   ;Resource Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Resource;
                                                   CaptionML=[ENU=Resource Filter;
                                                              FRA=Filtre ressource] }
    { 5954;   ;Contract Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="Service Contract Header"."Contract No." WHERE (Contract Type=CONST(Contract));
                                                   CaptionML=[ENU=Contract Filter;
                                                              FRA=Filtre contrat] }
    { 5955;   ;Ship-to Fax No.     ;Text30        ;CaptionML=[ENU=Ship-to Fax No.;
                                                              FRA=Nø t‚l‚copie destinataire] }
    { 5956;   ;Ship-to E-Mail      ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Ship-to E-Mail;
                                                              FRA=E-mail destinataire] }
    { 5957;   ;Resource Group Filter;Code20       ;FieldClass=FlowFilter;
                                                   TableRelation="Resource Group";
                                                   CaptionML=[ENU=Resource Group Filter;
                                                              FRA=Filtre gpe ressources] }
    { 5958;   ;Ship-to Phone       ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Ship-to Phone;
                                                              FRA=T‚l. destinataire] }
    { 5959;   ;Ship-to Phone 2     ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Ship-to Phone 2;
                                                              FRA=T‚l. 2 destinataire] }
    { 5966;   ;Service Zone Filter ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Service Zone".Code;
                                                   CaptionML=[ENU=Service Zone Filter;
                                                              FRA=Filtre zone service] }
    { 5968;   ;Service Zone Code   ;Code10        ;TableRelation="Service Zone".Code;
                                                   OnValidate=BEGIN
                                                                IF ShiptoAddr.GET("Customer No.","Ship-to Code") THEN
                                                                  "Service Zone Code" := ShiptoAddr."Service Zone Code"
                                                                ELSE
                                                                  IF Cust.GET("Customer No.") THEN
                                                                    "Service Zone Code" := Cust."Service Zone Code"
                                                                  ELSE
                                                                    "Service Zone Code" := '';
                                                              END;

                                                   CaptionML=[ENU=Service Zone Code;
                                                              FRA=Code zone service];
                                                   Editable=No }
    { 5981;   ;Expected Finishing Date;Date       ;CaptionML=[ENU=Expected Finishing Date;
                                                              FRA=Date fin pr‚vue] }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Allow Line Disc."));
                                                              END;

                                                   CaptionML=[ENU=Allow Line Disc.;
                                                              FRA=Autoriser remise ligne] }
    { 9000;   ;Assigned User ID    ;Code50        ;TableRelation="User Setup";
                                                   OnValidate=BEGIN
                                                                IF NOT UserSetupMgt.CheckRespCenter2(2,"Responsibility Center","Assigned User ID") THEN
                                                                  ERROR(
                                                                    Text060,"Assigned User ID",
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetServiceFilter2("Assigned User ID"));
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              FRA=Code utilisateur affect‚] }
    { 9001;   ;Quote No.           ;Code20        ;CaptionML=[ENU=Quote No.;
                                                              FRA=Nø devis] }
  }
  KEYS
  {
    {    ;Document Type,No.                       ;Clustered=Yes }
    {    ;No.,Document Type                        }
    {    ;Customer No.,Order Date                  }
    {    ;Contract No.,Status,Posting Date         }
    {    ;Status,Response Date,Response Time,Priority }
    {    ;Status,Priority,Response Date,Response Time }
    {    ;Document Type,Customer No.,Order Date   ;MaintainSQLIndex=No }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Document Type,No.,Customer No.,Posting Date,Status }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst '@@@="%1=Responsibility center table caption;%2=User management service filter;";ENU=You cannot delete this document. Your identification is set up to process from %1 %2 only.;FRA=Vous ne pouvez pas supprimer ce document. Le param‚trage de votre code utilisateur ne vous permet de travailler que sur %1 %2.';
      Text001@1001 : TextConst 'ENU=Changing %1 in service header %2 will not update the existing service lines.\You must update the existing service lines manually.;FRA=La modification de %1 dans l''en-tˆte de service %2 ne met pas … jour les lignes service existantes.\Vous devez mettre … jour les lignes service existantes manuellement.';
      Text002@1095 : TextConst 'ENU=Do you want to print credit memo %1?;FRA=Souhaitez-vous imprimer l''avoir %1?';
      Text003@1003 : TextConst '@@@="%1=Customer number field caption;%2=Document type;%3=Number field caption;%4=Number;%5=Contract number field caption;%6=Contract number; ";ENU=You cannot change the %1 because the %2 %3 %4 is associated with a %5 %6.;FRA=Vous ne pouvez pas modifier le %1, car le %2 %3 %4 est associ‚ … un %5 %6.';
      Text004@1004 : TextConst 'ENU=When you change the %1 the existing Service item line and service line will be deleted.\Do you want to change the %1?;FRA=Si vous modifiez %1, la ligne article service et la ligne service existantes seront supprim‚es.\Voulez-vous modifier %1 ?';
      Text005@1005 : TextConst 'ENU=Do you want to change the %1?;FRA=Souhaitez-vous modifier l''enregistrement %1 ?';
      Text007@1007 : TextConst 'ENU=%1 cannot be greater than %2.;FRA=L''%1 ne peut pas ˆtre sup‚rieur … l''%2.';
      Text008@1008 : TextConst '@@@="%1=Document type format;%2=Number field caption;%3=Number;";ENU="You cannot create Service %1 with %2=%3 because this number has already been used in the system.";FRA="Vous ne pouvez pas cr‚er de %1 Service avec %2=%3 car cette valeur a d‚j… ‚t‚ utilis‚e dans le systŠme."';
      Text010@1010 : TextConst '@@@="%1=Resposibility center table caption;%2=User management service filter;";ENU=Your identification is set up to process from %1 %2 only.;FRA=Le param‚trage de votre code utilisateur ne vous permet de travailler que sur %1 %2.';
      Text011@1011 : TextConst 'ENU=%1 cannot be greater than %2 in the %3 table.;FRA=%1 ne peut pas ˆtre sup‚rieur(e) … %2 dans la table %3.';
      Text012@1012 : TextConst 'ENU=If you change %1, the existing service lines will be deleted and the program will create new service lines based on the new information on the header.\Do you want to change the %1?;FRA=Si vous modifiez %1, les lignes service existantes seront supprim‚es et le programme cr‚era des lignes service bas‚es sur les nouvelles informations de l''en-tˆte.\Voulez-vous modifier %1 ?';
      Text013@1089 : TextConst 'ENU=Deleting this document will cause a gap in the number series for posted credit memos. An empty posted credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?;FRA=La suppression de ce document va engendrer une discontinuit‚ dans la souche d''avoirs enregistr‚s. Un avoir enregistr‚ vide %1 va ˆtre cr‚‚ pour ‚viter une discontinuit‚ dans la souche de num‚ros.\\Voulez-vous continuerÿ?';
      Text015@1015 : TextConst 'ENU=Do you want to update the exchange rate?;FRA=Souhaitez-vous mettre … jour le taux de change ?';
      Text016@1016 : TextConst 'ENU=You have modified %1.\Do you want to update the service lines?;FRA=Vous avez modifi‚ %1.\Voulez-vous mettre … jour les lignes service ?';
      Text018@1018 : TextConst '@@@="%1=Service order type field caption;%2=table caption;%3=Document type field caption;%4=Document type format;%5=Number field caption;%6=Number format;";ENU="You have not specified the %1 for %2 %3=%4, %5=%6.";FRA="Vous n''avez pas d‚fini le %1 pour %2 %3=%4, %5=%6."';
      Text019@1019 : TextConst 'ENU=You have changed %1 on the service header, but it has not been changed on the existing service lines.\The change may affect the exchange rate used in the price calculation of the service lines.;FRA=Vous avez modifi‚ %1 dans l''en-tˆte service, mais il n''a pas ‚t‚ modifi‚ dans les lignes service existantes.\Ce changement peut affecter le taux de change utilis‚ dans le calcul de prix des lignes service.';
      Text021@1021 : TextConst 'ENU=You have changed %1 on the %2, but it has not been changed on the existing service lines.\You must update the existing service lines manually.;FRA=Vous avez modifi‚ %1 du/de la %2, mais il/elle n''a pas ‚t‚ modifi‚(e) sur les lignes service existantes.\Vous devez mettre … jour les lignes service existantes manuellement.';
      ServSetup@1023 : Record 5911;
      Cust@1024 : Record 18;
      ServHeader@1025 : Record 5900;
      ServLine@1026 : Record 5902;
      ServItemLine@1027 : Record 5901;
      ShiptoAddr@1028 : Record 222;
      ServOrderAlloc@1029 : Record 5950;
      ServCommentLine@1030 : Record 5906;
      PostCode@1031 : Record 225;
      GenBusPostingGrp@1032 : Record 250;
      CurrExchRate@1033 : Record 330;
      GLSetup@1034 : Record 98;
      RespCenter@1035 : Record 5714;
      ServContract@1036 : Record 5965;
      ServContractLine@1072 : Record 5964;
      RepairStatus@1058 : Record 5927;
      Loaner@1066 : Record 5913;
      LoanerEntry@1065 : Record 5914;
      GLAcc@1006 : Record 15;
      GenJnlLine@1014 : Record 81;
      BankAcc@1049 : Record 270;
      PaymentTerms@1074 : Record 3;
      PaymentMethod@1067 : Record 289;
      CustLedgEntry@1086 : Record 21;
      ServShptHeader@1085 : Record 5990;
      ServInvHeader@1084 : Record 5992;
      ServCrMemoHeader@1077 : Record 5994;
      ReservEntry@1076 : Record 337;
      TempReservEntry@1075 : TEMPORARY Record 337;
      ServOrderMgt@1037 : Codeunit 5900;
      DimMgt@1038 : Codeunit 408;
      NoSeriesMgt@1039 : Codeunit 396;
      ServLogMgt@1040 : Codeunit 5906;
      CustCheckCreditLimit@1041 : Codeunit 312;
      TransferExtendedText@1042 : Codeunit 378;
      UserSetupMgt@1043 : Codeunit 5700;
      NotifyCust@1044 : Codeunit 5915;
      GenJnlApply@1009 : Codeunit 225;
      ServPost@1101 : Codeunit 5980;
      ServContractList@1071 : Page 6051;
      CurrencyDate@1046 : Date;
      TempLinkToServItem@1047 : Boolean;
      HideValidationDialog@1048 : Boolean;
      Text024@1002 : TextConst 'ENU=The %1 cannot be greater than the minimum %1 of the\ Service Item Lines.;FRA=Le/la %1 ne peut pas ˆtre sup‚rieur(e) au/… la %1 minimum des\ lignes article service.';
      Text025@1050 : TextConst 'ENU=The %1 cannot be less than the maximum %1 of the related\ Service Item Lines.;FRA=Le/la %1 ne peut pas ˆtre inf‚rieur(e) au/… la %1 maximum des\ lignes article service associ‚es.';
      Text026@1051 : TextConst 'ENU=%1 cannot be earlier than the %2.;FRA=%1 ne doit pas ˆtre ant‚rieure au %2.';
      Text027@1052 : TextConst 'ENU=The %1 cannot be greater than the minimum %2 of the related\ Service Item Lines.;FRA=Le/la %1 ne peut pas ˆtre sup‚rieur(e) au/… la %2 minimum des\ lignes article service associ‚es.';
      ValidatingFromLines@1053 : Boolean;
      LinesExist@1054 : Boolean;
      Text028@1057 : TextConst 'ENU=You cannot change the %1 because %2 exists.;FRA=Vous ne pouvez pas modifier %1 parce que il existe des %2.';
      Text029@1056 : TextConst 'ENU=The %1 field on the %2 will be updated if you change %3 manually.\Do you want to continue?;FRA=Le champ %1 du formulaire %2 sera mis … jour si vous modifiez manuellement la valeur %3.\Voulez-vous continuer ?';
      Text031@1059 : TextConst '@@@="%1=Status field caption;%2=Status format;%3=table caption;%4=Number;%5=ServItemLine repair status code field caption;%6=ServItemLine repair status code;%7=ServItemLine table caption;%8=ServItemLine line number;";ENU=You cannot change %1 to %2 in %3 %4.\\%5 %6 in %7 %8 line is preventing it.;FRA=Vous ne pouvez pas modifier %1 en %2 dans %3%4.\\%5%6 de la ligne %7 %8 vous empˆche de le faire.';
      Text037@1060 : TextConst '@@@="%1=Contact number;%2=Contact name;%3=Customer number;";ENU=Contact %1 %2 is not related to customer %3.;FRA=Le contact %1 %2 n''est pas associ‚ au client %3.';
      Text038@1013 : TextConst '@@@="%1=Contact number;%2=Contact name;%3=Customer number;";ENU=Contact %1 %2 is related to a different company than customer %3.;FRA=Le contact %1 %2 est associ‚ … une soci‚t‚ diff‚rente de celle du client %3.';
      Text039@1061 : TextConst '@@@="%1=Contact number;%2=Contact name;";ENU=Contact %1 %2 is not related to a customer.;FRA=Le contact %1 %2 n''est associ‚ … aucun client.';
      ContactNo@1045 : Code[20];
      Text040@1063 : TextConst '@@@="%1=table caption;%2=ServItemLine document number;%3=ServItemLine line number;%4=ServItemLine loaner number field caption;%5=ServItemLine loaner number;";ENU=You cannot delete %1 %2 because the %4 %5 for Service Item Line %3 has not been received.;FRA=Vous ne pouvez pas supprimer la %1 %2, car l''%4 %5 pour la ligne article de service %3 n''a pas ‚t‚ r‚ceptionn‚.';
      SkipContact@1064 : Boolean;
      SkipBillToContact@1062 : Boolean;
      Text041@1068 : TextConst 'ENU=Contract %1 is not signed.;FRA=Le contrat %1 n''a pas ‚t‚ sign‚.';
      Text042@1069 : TextConst 'ENU=The service period for contract %1 has not yet started.;FRA=La p‚riode de service du contrat %1 n''a pas encore commenc‚.';
      Text043@1070 : TextConst 'ENU=The service period for contract %1 has expired.;FRA=La p‚riode de service du contrat %1 a expir‚.';
      Text044@1073 : TextConst 'ENU=You cannot rename a %1.;FRA=Vous ne pouvez pas renommer l''enregistrement %1.';
      Confirmed@1080 : Boolean;
      Text045@1083 : TextConst '@@@="%1=Posting date field caption;%2=Posting number series field caption;%3=Posting number series;%4=NoSeries date order field caption;%5=NoSeries date order;%6=Document type;%7=posting number field caption;%8=Posting number;";ENU="You can not change the %1 field because %2 %3 has %4 = %5 and the %6 has already been assigned %7 %8.";FRA="Vous ne pouvez pas modifier le champ %1 car %2 %3 a %4 = %5 et %6 a d‚j… ‚t‚ affect‚(e) … %7 %8."';
      Text046@1104 : TextConst 'ENU=You cannot delete invoice %1 because one or more service ledger entries exist for this invoice.;FRA=Vous ne pouvez pas supprimer la facture %1 car il existe une ou plusieurs ‚critures comptables service pour cette facture.';
      Text047@1100 : TextConst 'ENU=You cannot change %1 because reservation, item tracking, or order tracking exists on the sales order.;FRA=Vous ne pouvez pas modifier %1 car une r‚servation, une tra‡abilit‚ ou un chaŒnage existe sur la commande vente.';
      Text048@1097 : TextConst 'ENU=Do you want to print shipment %1?;FRA=Souhaitez-vous imprimer le B.L. %1?';
      Text049@1096 : TextConst 'ENU=Do you want to print invoice %1?;FRA=Souhaitez-vous imprimer la facture %1?';
      Text050@1094 : TextConst 'ENU=You cannot reset %1 because the document still has one or more lines.;FRA=Impossible de r‚initialiser %1 car le document contient une ou plusieurs ligne(s).';
      Text051@1082 : TextConst '@@@="%1=Document type format;%2=Number;";ENU=The service %1 %2 already exists.;FRA=Le service %1 %2 existe d‚j….';
      Text052@1098 : TextConst '@@@="%1=Document type format;%2=Number;";ENU=The service %1 %2 has item tracking. Do you want to delete it anyway?;FRA=Le service %1 %2 a une tra‡abilit‚. Souhaitez-vous quand mˆme le supprimer ?';
      Text053@1093 : TextConst 'ENU=Deleting this document will cause a gap in the number series for shipments. An empty shipment %1 will be created to fill this gap in the number series.\\Do you want to continue?;FRA=La suppression de ce document va engendrer une discontinuit‚ dans la souche exp‚dition. Une exp‚dition vide %1 va ˆtre cr‚‚e pour ‚viter une discontinuit‚ dans la souche de num‚ros.\\Voulez-vous continuerÿ?';
      Text054@1091 : TextConst 'ENU=Deleting this document will cause a gap in the number series for posted invoices. An empty posted invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?;FRA=La suppression de ce document va engendrer une discontinuit‚ dans la souche des factures enregistr‚es. Une facture enregistr‚e vide %1 va ˆtre cr‚‚e pour ‚viter une discontinuit‚ dans la souche de num‚ros.\\Voulez-vous continuerÿ?';
      Text055@1079 : TextConst 'ENU=You have modified the %1 field. Note that the recalculation of VAT may cause penny differences, so you must check the amounts afterwards. Do you want to update the %2 field on the lines to reflect the new value of %1?;FRA=Vous avez modifi‚ le champ %1. Le recalcul de la TVA va provoquer de petites diff‚rences et vous devrez donc v‚rifier les montants par la suite. Voulez-vous mettre … jour le champ %2 sur les lignes pour refl‚ter la nouvelle valeur de %1 ?';
      Text057@1103 : TextConst 'ENU=When you change the %1 the existing service line will be deleted.\Do you want to change the %1?;FRA=Si vous modifiez %1, la ligne service existante sera supprim‚e.\Voulez-vous vraiment modifier %1 ?';
      Text058@1088 : TextConst '@@@="%1=Currency code field caption;%2=Document type;%3=Number;%4=Contract number;";ENU=You cannot change %1 because %2 %3 is linked to Contract %4.;FRA=Vous ne pouvez pas modifier le %1 car %2 %3 est li‚(e) au contrat %4.';
      Text060@1154 : TextConst '@@@="%1=Assigned user ID;%2=Responsibility Center table caption;%2=User management service filter assigned user id;";ENU=%1 is set up to process from %2 %3 only.;FRA=%1 est param‚tr‚ pour traiter uniquement … partir de %2 %3.';
      Text061@1099 : TextConst 'ENU=You may have changed a dimension.\\Do you want to update the lines?;FRA=Vous avez probablement modifi‚ un axe analytique.\\Souhaitez-vous mettre … jour les lignesÿ?';
      Text062@1087 : TextConst 'ENU=An open inventory pick exists for the %1 and because %2 is %3.\\You must first post or delete the inventory pick or change %2 to Partial.;FRA=Il existe un pr‚lŠvement stock ouvert pour le %1 et parce que %2 est %3.\\Vous devez tout d''abord valider ou supprimer le pr‚lŠvement stock ou changer %2 par Partielle.';
      Text063@1102 : TextConst 'ENU=An open warehouse shipment exists for the %1 and %2 is %3.\\You must add the item(s) as new line(s) to the existing warehouse shipment or change %2 to Partial.;FRA=Il existe une exp‚dition entrep“t ouverte pour le %1 et %2 est %3.\\Vous devez ajouter les articles comme nouvelles lignes … l''exp‚dition entrep“t existante ou changer %2 par Partielle.';
      Text064@1105 : TextConst 'ENU=You cannot change %1 to %2 because an open inventory pick on the %3.;FRA=Vous ne pouvez pas modifier %1 en %2 car un pr‚lŠvement stock est ouvert sur %3.';
      Text065@1106 : TextConst 'ENU=You cannot change %1  to %2 because an open warehouse shipment exists for the %3.;FRA=Vous ne pouvez pas modifier %1 en %2 car il existe une exp‚dition entrep“t ouverte pour %3.';
      Text066@1017 : TextConst 'ENU=You cannot change the dimension because there are service entries connected to this line.;FRA=Vous ne pouvez pas modifier l''axe car des ‚critures service sont connect‚es … cette ligne.';

    PROCEDURE AssistEdit@1(OldServHeader@1000 : Record 5900) : Boolean;
    VAR
      ServHeader2@1001 : Record 5900;
    BEGIN
      WITH ServHeader DO BEGIN
        COPY(Rec);
        ServSetup.GET;
        TestNoSeries;
        IF NoSeriesMgt.SelectSeries(GetNoSeriesCode,OldServHeader."No. Series","No. Series") THEN BEGIN
          IF ("Customer No." = '') AND ("Contact No." = '') THEN
            CheckCreditMaxBeforeInsert(FALSE);

          NoSeriesMgt.SetSeries("No.");
          IF ServHeader2.GET("Document Type","No.") THEN
            ERROR(Text051,LOWERCASE(FORMAT("Document Type")),"No.");
          Rec := ServHeader;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE CreateDim@16(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1004 : Integer;No3@1005 : Code[20];Type4@1006 : Integer;No4@1007 : Code[20];Type5@1012 : Integer;No5@1011 : Code[20]);
    VAR
      SourceCodeSetup@1008 : Record 242;
      ServiceContractHeader@1015 : Record 5965;
      No@1010 : ARRAY [10] OF Code[20];
      TableID@1009 : ARRAY [10] OF Integer;
      DimensionSetIDArr@1014 : ARRAY [10] OF Integer;
      OldDimSetID@1013 : Integer;
    BEGIN
      SourceCodeSetup.GET;

      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      TableID[3] := Type3;
      No[3] := No3;
      TableID[4] := Type4;
      No[4] := No4;
      TableID[5] := Type5;
      No[5] := No5;

      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      OldDimSetID := "Dimension Set ID";

      DimensionSetIDArr[1] :=
        DimMgt.GetDefaultDimID(
          TableID,No,SourceCodeSetup."Service Management",
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",0,0);

      IF "Contract No." <> '' THEN BEGIN
        ServiceContractHeader.GET(ServiceContractHeader."Contract Type"::Contract,"Contract No.");
        DimensionSetIDArr[2] := ServiceContractHeader."Dimension Set ID";
      END;

      "Dimension Set ID" :=
        DimMgt.GetCombinedDimensionSetID(
          DimensionSetIDArr,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");

      IF ("Dimension Set ID" <> OldDimSetID) AND (ServItemLineExists OR ServLineExists) THEN BEGIN
        MODIFY;
        UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    PROCEDURE UpdateAllLineDim@41(NewParentDimSetID@1000 : Integer;OldParentDimSetID@1001 : Integer);
    VAR
      NewDimSetID@1002 : Integer;
    BEGIN
      // Update all lines with changed dimensions.
      IF NewParentDimSetID = OldParentDimSetID THEN
        EXIT;
      IF NOT CONFIRM(Text061) THEN
        EXIT;

      ServLine.RESET;
      ServLine.SETRANGE("Document Type","Document Type");
      ServLine.SETRANGE("Document No.","No.");
      ServLine.LOCKTABLE;
      IF ServLine.FIND('-') THEN
        REPEAT
          NewDimSetID := DimMgt.GetDeltaDimSetID(ServLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          IF ServLine."Dimension Set ID" <> NewDimSetID THEN BEGIN
            ServLine."Dimension Set ID" := NewDimSetID;
            DimMgt.UpdateGlobalDimFromDimSetID(
              ServLine."Dimension Set ID",ServLine."Shortcut Dimension 1 Code",ServLine."Shortcut Dimension 2 Code");
            ServLine.MODIFY;
          END;
        UNTIL ServLine.NEXT = 0;

      ServItemLine.RESET;
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      ServItemLine.LOCKTABLE;
      IF ServItemLine.FIND('-') THEN
        REPEAT
          NewDimSetID := DimMgt.GetDeltaDimSetID(ServItemLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          IF ServItemLine."Dimension Set ID" <> NewDimSetID THEN BEGIN
            ServItemLine."Dimension Set ID" := NewDimSetID;
            DimMgt.UpdateGlobalDimFromDimSetID(
              ServItemLine."Dimension Set ID",ServItemLine."Shortcut Dimension 1 Code",ServItemLine."Shortcut Dimension 2 Code");
            ServItemLine.MODIFY;
          END;
        UNTIL ServItemLine.NEXT = 0;
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@19(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1002 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");

      IF ServItemLineExists OR ServLineExists THEN
        UpdateAllLineDim("Dimension Set ID",OldDimSetID);
    END;

    LOCAL PROCEDURE LookupShortcutDimCode@18(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    LOCAL PROCEDURE UpdateCurrencyFactor@12();
    BEGIN
      IF "Currency Code" <> '' THEN BEGIN
        CurrencyDate := "Posting Date";
        "Currency Factor" := CurrExchRate.ExchangeRate(CurrencyDate,"Currency Code");
      END ELSE
        "Currency Factor" := 0;
    END;

    LOCAL PROCEDURE RecreateServLines@2(ChangedFieldName@1000 : Text[100]);
    VAR
      TempServLine@1002 : TEMPORARY Record 5902;
      ServDocReg@1005 : Record 5936;
      TempServDocReg@1004 : TEMPORARY Record 5936;
      ExtendedTextAdded@1003 : Boolean;
    BEGIN
      IF ServLineExists THEN BEGIN
        IF HideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE
          Confirmed :=
            CONFIRM(
              Text012,
              FALSE,ChangedFieldName);
        IF Confirmed THEN BEGIN
          ServLine.LOCKTABLE;
          ReservEntry.LOCKTABLE;
          MODIFY;

          ServLine.RESET;
          ServLine.SETRANGE("Document Type","Document Type");
          ServLine.SETRANGE("Document No.","No.");
          IF ServLine.FIND('-') THEN BEGIN
            REPEAT
              ServLine.TESTFIELD("Quantity Shipped",0);
              ServLine.TESTFIELD("Quantity Invoiced",0);
              ServLine.TESTFIELD("Shipment No.",'');
              TempServLine := ServLine;
              IF ServLine.Nonstock THEN BEGIN
                ServLine.Nonstock := FALSE;
                ServLine.MODIFY;
              END;
              TempServLine.INSERT;
              RecreateReservEntry(ServLine,0,TRUE);
            UNTIL ServLine.NEXT = 0;

            IF "Location Code" <> xRec."Location Code" THEN
              IF NOT TempReservEntry.ISEMPTY THEN
                ERROR(Text047,FIELDCAPTION("Location Code"));

            IF "Document Type" = "Document Type"::Invoice THEN BEGIN
              ServDocReg.SETCURRENTKEY("Destination Document Type","Destination Document No.");
              ServDocReg.SETRANGE("Destination Document Type",ServDocReg."Destination Document Type"::Invoice);
              ServDocReg.SETRANGE("Destination Document No.",TempServLine."Document No.");
              IF ServDocReg.FIND('-') THEN
                REPEAT
                  TempServDocReg := ServDocReg;
                  TempServDocReg.INSERT;
                UNTIL ServDocReg.NEXT = 0;
            END;
            ServLine.DELETEALL(TRUE);

            IF "Document Type" = "Document Type"::Invoice THEN BEGIN
              IF TempServDocReg.FIND('-') THEN
                REPEAT
                  ServDocReg := TempServDocReg;
                  ServDocReg.INSERT;
                UNTIL TempServDocReg.NEXT = 0;
            END;

            CreateServiceLines(TempServLine,ExtendedTextAdded);
            TempServLine.SETRANGE(Type);
            TempServLine.DELETEALL;
          END;
        END ELSE
          ERROR('');
      END;
    END;

    LOCAL PROCEDURE ConfirmUpdateCurrencyFactor@13();
    BEGIN
      IF CONFIRM(Text015,FALSE) THEN
        VALIDATE("Currency Factor")
      ELSE
        "Currency Factor" := xRec."Currency Factor";
    END;

    LOCAL PROCEDURE UpdateServLines@15(ChangedFieldName@1000 : Text[100];AskQuestion@1001 : Boolean);
    VAR
      Question@1002 : Text[250];
    BEGIN
      IF ServLineExists AND AskQuestion THEN BEGIN
        Question := STRSUBSTNO(
            Text016,
            ChangedFieldName);
        IF GUIALLOWED AND NOT DIALOG.CONFIRM(Question,TRUE) THEN
          EXIT
      END;

      IF ServLineExists THEN BEGIN
        ServLine.LOCKTABLE;
        ServLine.RESET;
        ServLine.SETRANGE("Document Type","Document Type");
        ServLine.SETRANGE("Document No.","No.");

        ServLine.SETRANGE("Quantity Shipped",0);
        ServLine.SETRANGE("Quantity Invoiced",0);
        ServLine.SETRANGE("Quantity Consumed",0);
        ServLine.SETRANGE("Shipment No.",'');

        IF ServLine.FIND('-') THEN
          REPEAT
            CASE ChangedFieldName OF
              FIELDCAPTION("Currency Factor"):
                IF (ServLine."Posting Date" = "Posting Date") AND (ServLine.Type <> ServLine.Type::" ") THEN BEGIN
                  ServLine.VALIDATE("Unit Price");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Posting Date"):
                BEGIN
                  ServLine.VALIDATE("Posting Date","Posting Date");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Responsibility Center"):
                BEGIN
                  ServLine.VALIDATE("Responsibility Center","Responsibility Center");
                  ServLine.MODIFY(TRUE);
                  ServItemLine.RESET;
                  ServItemLine.SETRANGE("Document Type","Document Type");
                  ServItemLine.SETRANGE("Document No.","No.");
                  IF ServItemLine.FIND('-') THEN
                    REPEAT
                      ServItemLine.VALIDATE("Responsibility Center","Responsibility Center");
                      ServItemLine.MODIFY(TRUE);
                    UNTIL ServItemLine.NEXT = 0;
                END;
              FIELDCAPTION("Order Date"):
                BEGIN
                  ServLine."Order Date" := "Order Date";
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Transaction Type"):
                BEGIN
                  ServLine.VALIDATE("Transaction Type","Transaction Type");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Transport Method"):
                BEGIN
                  ServLine.VALIDATE("Transport Method","Transport Method");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Exit Point"):
                BEGIN
                  ServLine.VALIDATE("Exit Point","Exit Point");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION(Area):
                BEGIN
                  ServLine.VALIDATE(Area,Area);
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Transaction Specification"):
                BEGIN
                  ServLine.VALIDATE("Transaction Specification","Transaction Specification");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Shipping Agent Code"):
                BEGIN
                  ServLine.VALIDATE("Shipping Agent Code","Shipping Agent Code");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Shipping Time"):
                BEGIN
                  ServLine.VALIDATE("Shipping Time","Shipping Time");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Shipping Agent Service Code"):
                BEGIN
                  ServLine.VALIDATE("Shipping Agent Service Code","Shipping Agent Service Code");
                  ServLine.MODIFY(TRUE);
                END;
            END;
          UNTIL ServLine.NEXT = 0;
      END;
    END;

    PROCEDURE TestMandatoryFields@9(VAR PassedServLine@1002 : Record 5902);
    BEGIN
      ServSetup.GET;
      CheckMandSalesPersonOrderData(ServSetup);
      PassedServLine.RESET;
      ServLine.RESET;
      ServLine.SETRANGE("Document Type","Document Type");
      ServLine.SETRANGE("Document No.","No.");

      IF PassedServLine.FIND('-') THEN
        REPEAT
          IF (PassedServLine."Qty. to Ship" <> 0) OR
             (PassedServLine."Qty. to Invoice" <> 0) OR
             (PassedServLine."Qty. to Consume" <> 0)
          THEN BEGIN
            IF ("Document Type" = "Document Type"::Order) AND
               "Link Service to Service Item" AND
               (PassedServLine.Type IN [PassedServLine.Type::Item,PassedServLine.Type::Resource])
            THEN
              PassedServLine.TESTFIELD("Service Item Line No.");

            CASE PassedServLine.Type OF
              PassedServLine.Type::Item:
                BEGIN
                  IF ServSetup."Unit of Measure Mandatory" THEN
                    PassedServLine.TESTFIELD("Unit of Measure Code");
                END;
              PassedServLine.Type::Resource:
                BEGIN
                  IF ServSetup."Work Type Code Mandatory" THEN
                    PassedServLine.TESTFIELD("Work Type Code");
                  IF ServSetup."Unit of Measure Mandatory" THEN
                    PassedServLine.TESTFIELD("Unit of Measure Code");
                END;
              PassedServLine.Type::Cost:
                IF ServSetup."Unit of Measure Mandatory" THEN
                  PassedServLine.TESTFIELD("Unit of Measure Code");
            END;

            IF PassedServLine."Job No." <> '' THEN
              PassedServLine.TESTFIELD("Qty. to Consume",PassedServLine."Qty. to Ship");
          END;
        UNTIL PassedServLine.NEXT = 0
      ELSE
        IF ServLine.FIND('-') THEN
          REPEAT
            IF (ServLine."Qty. to Ship" <> 0) OR
               (ServLine."Qty. to Invoice" <> 0) OR
               (ServLine."Qty. to Consume" <> 0)
            THEN BEGIN
              IF ("Document Type" = "Document Type"::Order) AND
                 "Link Service to Service Item" AND
                 (ServLine.Type IN [ServLine.Type::Item,ServLine.Type::Resource])
              THEN
                ServLine.TESTFIELD("Service Item Line No.");

              CASE ServLine.Type OF
                ServLine.Type::Item:
                  BEGIN
                    IF ServSetup."Unit of Measure Mandatory" THEN
                      ServLine.TESTFIELD("Unit of Measure Code");
                  END;
                ServLine.Type::Resource:
                  BEGIN
                    IF ServSetup."Work Type Code Mandatory" THEN
                      ServLine.TESTFIELD("Work Type Code");
                    IF ServSetup."Unit of Measure Mandatory" THEN
                      ServLine.TESTFIELD("Unit of Measure Code");
                  END;
                ServLine.Type::Cost:
                  IF ServSetup."Unit of Measure Mandatory" THEN
                    ServLine.TESTFIELD("Unit of Measure Code");
              END;

              IF ServLine."Job No." <> '' THEN
                ServLine.TESTFIELD("Qty. to Consume",ServLine."Qty. to Ship");
            END;
          UNTIL ServLine.NEXT = 0;
    END;

    PROCEDURE UpdateResponseDateTime@3();
    BEGIN
      ServItemLine.RESET;
      ServItemLine.SETCURRENTKEY("Document Type","Document No.","Response Date");
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      IF ServItemLine.FIND('-') THEN BEGIN
        "Response Date" := ServItemLine."Response Date";
        "Response Time" := ServItemLine."Response Time";
        MODIFY(TRUE);
      END;
    END;

    LOCAL PROCEDURE UpdateStartingDateTime@5();
    BEGIN
      IF ValidatingFromLines THEN
        EXIT;
      ServItemLine.RESET;
      ServItemLine.SETCURRENTKEY("Document Type","Document No.","Starting Date");
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      ServItemLine.SETFILTER("Starting Date",'<>%1',0D);
      IF ServItemLine.FIND('-') THEN BEGIN
        "Starting Date" := ServItemLine."Starting Date";
        "Starting Time" := ServItemLine."Starting Time";
        MODIFY(TRUE);
      END ELSE BEGIN
        "Starting Date" := 0D;
        "Starting Time" := 0T;
      END;
    END;

    LOCAL PROCEDURE UpdateFinishingDateTime@8();
    BEGIN
      IF ValidatingFromLines THEN
        EXIT;
      ServItemLine.RESET;
      ServItemLine.SETCURRENTKEY("Document Type","Document No.","Finishing Date");
      ServItemLine.ASCENDING := FALSE;
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      ServItemLine.SETFILTER("Finishing Date",'<>%1',0D);
      IF ServItemLine.FIND('-') THEN BEGIN
        "Finishing Date" := ServItemLine."Finishing Date";
        "Finishing Time" := ServItemLine."Finishing Time";
        MODIFY(TRUE);
      END ELSE BEGIN
        "Finishing Date" := 0D;
        "Finishing Time" := 0T;
      END;
    END;

    LOCAL PROCEDURE PriceMsgIfServLinesExist@10(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF ServLineExists THEN
        MESSAGE(
          Text019,
          ChangedFieldName);
    END;

    LOCAL PROCEDURE ServItemLineExists@4() : Boolean;
    VAR
      ServItemLine@1000 : Record 5901;
    BEGIN
      ServItemLine.RESET;
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      EXIT(ServItemLine.FINDFIRST);
    END;

    LOCAL PROCEDURE ServLineExists@11() : Boolean;
    BEGIN
      ServLine.RESET;
      ServLine.SETRANGE("Document Type","Document Type");
      ServLine.SETRANGE("Document No.","No.");
      EXIT(ServLine.FIND('-'));
    END;

    LOCAL PROCEDURE MessageIfServLinesExist@7(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF ServLineExists AND NOT HideValidationDialog THEN
        MESSAGE(
          Text021,
          ChangedFieldName,TABLECAPTION);
    END;

    LOCAL PROCEDURE ValidateServPriceGrOnServItem@6();
    BEGIN
      ServItemLine.RESET;
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      IF ServItemLine.FIND('-') THEN BEGIN
        ServItemLine.SetServHeader(Rec);
        REPEAT
          IF ServItemLine."Service Price Group Code" <> '' THEN BEGIN
            ServItemLine.VALIDATE("Service Price Group Code");
            ServItemLine.MODIFY;
          END;
        UNTIL ServItemLine.NEXT = 0
      END;
    END;

    PROCEDURE SetHideValidationDialog@14(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    PROCEDURE SetValidatingFromLines@17(NewValidatingFromLines@1000 : Boolean);
    BEGIN
      ValidatingFromLines := NewValidatingFromLines;
    END;

    LOCAL PROCEDURE TestNoSeries@21();
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          ServSetup.TESTFIELD("Service Quote Nos.");
        "Document Type"::Order:
          ServSetup.TESTFIELD("Service Order Nos.");
      END;
    END;

    LOCAL PROCEDURE GetNoSeriesCode@20() : Code[10];
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(ServSetup."Service Quote Nos.");
        "Document Type"::Order:
          EXIT(ServSetup."Service Order Nos.");
        "Document Type"::Invoice:
          EXIT(ServSetup."Service Invoice Nos.");
        "Document Type"::"Credit Memo":
          EXIT(ServSetup."Service Credit Memo Nos.");
      END;
    END;

    LOCAL PROCEDURE TestNoSeriesManual@33();
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          NoSeriesMgt.TestManual(ServSetup."Service Quote Nos.");
        "Document Type"::Order:
          NoSeriesMgt.TestManual(ServSetup."Service Order Nos.");
        "Document Type"::Invoice:
          NoSeriesMgt.TestManual(ServSetup."Service Invoice Nos.");
        "Document Type"::"Credit Memo":
          NoSeriesMgt.TestManual(ServSetup."Service Credit Memo Nos.");
      END;
    END;

    LOCAL PROCEDURE UpdateCont@24(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cont@1002 : Record 5050;
      Cust@1004 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        CLEAR(ServOrderMgt);
        ContactNo := ServOrderMgt.FindContactInformation(Cust."No.");
        IF Cont.GET(ContactNo) THEN BEGIN
          "Contact No." := Cont."No.";
          "Contact Name" := Cont.Name;
          "Phone No." := Cont."Phone No.";
          "E-Mail" := Cont."E-Mail";
        END ELSE BEGIN
          IF Cust."Primary Contact No." <> '' THEN
            "Contact No." := Cust."Primary Contact No."
          ELSE BEGIN
            ContBusRel.RESET;
            ContBusRel.SETCURRENTKEY("Link to Table","No.");
            ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
            ContBusRel.SETRANGE("No.","Customer No.");
            IF ContBusRel.FINDFIRST THEN
              "Contact No." := ContBusRel."Contact No."
            ELSE
              "Contact No." := '';
          END;
          "Contact Name" := Cust.Contact;
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateBillToCont@27(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cont@1002 : Record 5050;
      Cust@1001 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        CLEAR(ServOrderMgt);
        ContactNo := ServOrderMgt.FindContactInformation("Bill-to Customer No.");
        IF Cont.GET(ContactNo) THEN BEGIN
          "Bill-to Contact No." := Cont."No.";
          "Bill-to Contact" := Cont.Name;
        END ELSE BEGIN
          IF Cust."Primary Contact No." <> '' THEN
            "Bill-to Contact No." := Cust."Primary Contact No."
          ELSE BEGIN
            ContBusRel.RESET;
            ContBusRel.SETCURRENTKEY("Link to Table","No.");
            ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
            ContBusRel.SETRANGE("No.","Bill-to Customer No.");
            IF ContBusRel.FINDFIRST THEN
              "Bill-to Contact No." := ContBusRel."Contact No."
            ELSE
              "Bill-to Contact No." := '';
          END;
          "Bill-to Contact" := Cust.Contact;
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateCust@25(ContactNo@1002 : Code[20]);
    VAR
      ContBusinessRelation@1007 : Record 5054;
      Cust@1006 : Record 18;
      Cont@1005 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Contact No." := Cont."No.";
        "Phone No." := Cont."Phone No.";
        "E-Mail" := Cont."E-Mail";
      END ELSE BEGIN
        "Phone No." := '';
        "E-Mail" := '';
        "Contact Name" := '';
        EXIT;
      END;

      IF Cont.Type = Cont.Type::Person THEN
        "Contact Name" := Cont.Name
      ELSE
        IF Cust.GET("Customer No.") THEN
          "Contact Name" := Cust.Contact
        ELSE
          "Contact Name" := '';

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF ("Customer No." <> '') AND
           ("Customer No." <> ContBusinessRelation."No.")
        THEN
          ERROR(Text037,Cont."No.",Cont.Name,"Customer No.");

        IF "Customer No." = '' THEN BEGIN
          SkipContact := TRUE;
          VALIDATE("Customer No.",ContBusinessRelation."No.");
          SkipContact := FALSE;
        END;
      END ELSE
        ERROR(Text039,Cont."No.",Cont.Name);

      IF ("Customer No." = "Bill-to Customer No.") OR
         ("Bill-to Customer No." = '')
      THEN
        VALIDATE("Bill-to Contact No.","Contact No.");
    END;

    LOCAL PROCEDURE UpdateBillToCust@26(ContactNo@1000 : Code[20]);
    VAR
      ContBusinessRelation@1005 : Record 5054;
      Cust@1004 : Record 18;
      Cont@1003 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Bill-to Contact No." := Cont."No.";
        IF Cont.Type = Cont.Type::Person THEN
          "Bill-to Contact" := Cont.Name
        ELSE
          IF Cust.GET("Bill-to Customer No.") THEN
            "Bill-to Contact" := Cust.Contact
          ELSE
            "Bill-to Contact" := '';
      END ELSE BEGIN
        "Bill-to Contact" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF "Bill-to Customer No." = '' THEN BEGIN
          SkipBillToContact := TRUE;
          VALIDATE("Bill-to Customer No.",ContBusinessRelation."No.");
          SkipBillToContact := FALSE;
        END ELSE
          IF "Bill-to Customer No." <> ContBusinessRelation."No." THEN
            ERROR(Text037,Cont."No.",Cont.Name,"Bill-to Customer No.");
      END ELSE
        ERROR(Text039,Cont."No.",Cont.Name);
    END;

    PROCEDURE CheckCreditMaxBeforeInsert@28(HideCreditCheckDialogue@1004 : Boolean);
    VAR
      ServHeader@1001 : Record 5900;
      ContBusinessRelation@1002 : Record 5054;
      Cont@1003 : Record 5050;
      CustCheckCreditLimit@1000 : Codeunit 312;
    BEGIN
      IF HideCreditCheckDialogue THEN
        EXIT;
      IF GETFILTER("Customer No.") <> '' THEN BEGIN
        IF GETRANGEMIN("Customer No.") = GETRANGEMAX("Customer No.") THEN BEGIN
          ServHeader."Bill-to Customer No." := GETRANGEMIN("Customer No.");
          CustCheckCreditLimit.ServiceHeaderCheck(ServHeader);
        END
      END ELSE
        IF GETFILTER("Contact No.") <> '' THEN
          IF GETRANGEMIN("Contact No.") = GETRANGEMAX("Contact No.") THEN BEGIN
            Cont.GET(GETRANGEMIN("Contact No."));
            ContBusinessRelation.RESET;
            ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
            ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
            ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
            IF ContBusinessRelation.FINDFIRST THEN BEGIN
              ServHeader."Bill-to Customer No." := ContBusinessRelation."No.";
              CustCheckCreditLimit.ServiceHeaderCheck(ServHeader);
            END;
          END;
    END;

    PROCEDURE UpdateServiceOrderChangeLog@22(VAR OldServHeader@1000 : Record 5900);
    BEGIN
      IF Status <> OldServHeader.Status THEN
        ServLogMgt.ServHeaderStatusChange(Rec,OldServHeader);

      IF "Customer No." <> OldServHeader."Customer No." THEN
        ServLogMgt.ServHeaderCustomerChange(Rec,OldServHeader);

      IF "Ship-to Code" <> OldServHeader."Ship-to Code" THEN
        ServLogMgt.ServHeaderShiptoChange(Rec,OldServHeader);

      IF "Contract No." <> OldServHeader."Contract No." THEN
        ServLogMgt.ServHeaderContractNoChanged(Rec,OldServHeader);
    END;

    LOCAL PROCEDURE GetPostingNoSeriesCode@39() : Code[10];
    BEGIN
      IF "Document Type" IN ["Document Type"::"Credit Memo"] THEN
        EXIT(ServSetup."Posted Serv. Credit Memo Nos.");
      EXIT(ServSetup."Posted Service Invoice Nos.");
    END;

    PROCEDURE InitRecord@32();
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote,"Document Type"::Order:
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",ServSetup."Posted Service Invoice Nos.");
            NoSeriesMgt.SetDefaultSeries("Shipping No. Series",ServSetup."Posted Service Shipment Nos.");
          END;
        "Document Type"::Invoice:
          BEGIN
            IF ("No. Series" <> '') AND
               (ServSetup."Service Invoice Nos." = ServSetup."Posted Service Invoice Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",ServSetup."Posted Service Invoice Nos.");
            IF ServSetup."Shipment on Invoice" THEN
              NoSeriesMgt.SetDefaultSeries("Shipping No. Series",ServSetup."Posted Service Shipment Nos.");
          END;
        "Document Type"::"Credit Memo":
          BEGIN
            IF ("No. Series" <> '') AND
               (ServSetup."Service Credit Memo Nos." = ServSetup."Posted Serv. Credit Memo Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",ServSetup."Posted Serv. Credit Memo Nos.");
          END;
      END;

      IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice,"Document Type"::Quote]
      THEN BEGIN
        "Order Date" := WORKDATE;
        "Order Time" := TIME;
      END;

      "Posting Date" := WORKDATE;
      "Document Date" := WORKDATE;
      "Default Response Time (Hours)" := ServSetup."Default Response Time (Hours)";
      "Link Service to Service Item" := ServSetup."Link Service to Service Item";

      IF Cust.GET("Customer No.") THEN
        VALIDATE("Location Code",UserSetupMgt.GetLocation(2,Cust."Location Code","Responsibility Center"));

      IF "Document Type" IN ["Document Type"::"Credit Memo"] THEN BEGIN
        GLSetup.GET;
        Correction := GLSetup."Mark Cr. Memos as Corrections";
      END;

      "Posting Description" := FORMAT("Document Type") + ' ' + "No.";

      Reserve := Reserve::Optional;

      IF Cust.GET("Customer No.") THEN
        "Responsibility Center" := UserSetupMgt.GetRespCenter(2,Cust."Responsibility Center")
      ELSE
        "Responsibility Center" := UserSetupMgt.GetServiceFilter;
    END;

    LOCAL PROCEDURE GetCust@30(CustNo@1000 : Code[20]);
    BEGIN
      IF NOT (("Document Type" = "Document Type"::Quote) AND (CustNo = '')) THEN BEGIN
        IF CustNo <> Cust."No." THEN
          Cust.GET(CustNo);
      END ELSE
        CLEAR(Cust);
    END;

    LOCAL PROCEDURE ShippedServLinesExist@31() : Boolean;
    BEGIN
      ServLine.RESET;
      ServLine.SETRANGE("Document Type","Document Type");
      ServLine.SETRANGE("Document No.","No.");
      ServLine.SETFILTER("Quantity Shipped",'<>0');
      EXIT(ServLine.FIND('-'));
    END;

    LOCAL PROCEDURE UpdateShipToAddress@29();
    VAR
      Location@1000 : Record 14;
      CompanyInfo@1001 : Record 79;
    BEGIN
      IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
        IF "Location Code" <> '' THEN BEGIN
          Location.GET("Location Code");
          "Ship-to Name" := Location.Name;
          "Ship-to Name 2" := Location."Name 2";
          "Ship-to Address" := Location.Address;
          "Ship-to Address 2" := Location."Address 2";
          "Ship-to City" := Location.City;
          "Ship-to Post Code" := Location."Post Code";
          "Ship-to County" := Location.County;
          "Ship-to Country/Region Code" := Location."Country/Region Code";
          "Ship-to Contact" := Location.Contact;
        END ELSE BEGIN
          CompanyInfo.GET;
          "Ship-to Code" := '';
          "Ship-to Name" := CompanyInfo."Ship-to Name";
          "Ship-to Name 2" := CompanyInfo."Ship-to Name 2";
          "Ship-to Address" := CompanyInfo."Ship-to Address";
          "Ship-to Address 2" := CompanyInfo."Ship-to Address 2";
          "Ship-to City" := CompanyInfo."Ship-to City";
          "Ship-to Post Code" := CompanyInfo."Ship-to Post Code";
          "Ship-to County" := CompanyInfo."Ship-to County";
          "Ship-to Country/Region Code" := CompanyInfo."Ship-to Country/Region Code";
          "Ship-to Contact" := CompanyInfo."Ship-to Contact";
        END;
        "VAT Country/Region Code" := "Country/Region Code";
      END;
    END;

    PROCEDURE ConfirmDeletion@36() : Boolean;
    BEGIN
      ServPost.TestDeleteHeader(Rec,ServShptHeader,ServInvHeader,ServCrMemoHeader);
      IF ServShptHeader."No." <> '' THEN
        IF NOT
           CONFIRM(
             Text053,
             TRUE,ServShptHeader."No.")
        THEN
          EXIT;
      IF ServInvHeader."No." <> '' THEN
        IF NOT
           CONFIRM(
             Text054,
             TRUE,ServInvHeader."No.")
        THEN
          EXIT;
      IF ServCrMemoHeader."No." <> '' THEN
        IF NOT
           CONFIRM(
             Text013,
             TRUE,ServCrMemoHeader."No.")
        THEN
          EXIT;
      EXIT(TRUE);
    END;

    PROCEDURE SetAmountToApply@35(AppliesToDocNo@1000 : Code[20];CurstomerNo@1001 : Code[20]);
    VAR
      CustLedgEntry@1002 : Record 21;
    BEGIN
      CustLedgEntry.SETCURRENTKEY("Document No.");
      CustLedgEntry.SETRANGE("Document No.",AppliesToDocNo);
      CustLedgEntry.SETRANGE("Customer No.",CurstomerNo);
      CustLedgEntry.SETRANGE(Open,TRUE);
      IF CustLedgEntry.FINDFIRST THEN BEGIN
        IF CustLedgEntry."Amount to Apply" = 0 THEN BEGIN
          CustLedgEntry.CALCFIELDS("Remaining Amount");
          CustLedgEntry."Amount to Apply" := CustLedgEntry."Remaining Amount";
        END ELSE
          CustLedgEntry."Amount to Apply" := 0;
        CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",CustLedgEntry);
      END;
    END;

    LOCAL PROCEDURE RecreateReservEntry@34(OldServLine@1000 : Record 5902;NewSourceRefNo@1001 : Integer;ToTemp@1002 : Boolean);
    BEGIN
      IF ToTemp THEN BEGIN
        CLEAR(ReservEntry);
        ReservEntry.SETCURRENTKEY("Source ID","Source Ref. No.","Source Type","Source Subtype");
        ReservEntry.SETRANGE("Source ID",OldServLine."Document No.");
        ReservEntry.SETRANGE("Source Ref. No.",OldServLine."Line No.");
        ReservEntry.SETRANGE("Source Type",DATABASE::"Service Line");
        ReservEntry.SETRANGE("Source Subtype",OldServLine."Document Type");
        IF ReservEntry.FINDSET THEN
          REPEAT
            TempReservEntry := ReservEntry;
            TempReservEntry.INSERT;
          UNTIL ReservEntry.NEXT = 0;
        ReservEntry.DELETEALL;
      END ELSE BEGIN
        CLEAR(TempReservEntry);
        TempReservEntry.SETCURRENTKEY("Source ID","Source Ref. No.","Source Type","Source Subtype");
        TempReservEntry.SETRANGE("Source Type",DATABASE::"Service Line");
        TempReservEntry.SETRANGE("Source Subtype",OldServLine."Document Type");
        TempReservEntry.SETRANGE("Source ID",OldServLine."Document No.");
        TempReservEntry.SETRANGE("Source Ref. No.",OldServLine."Line No.");
        IF TempReservEntry.FINDSET THEN
          REPEAT
            ReservEntry := TempReservEntry;
            ReservEntry."Source Ref. No." := NewSourceRefNo;
            IF NOT ReservEntry.INSERT THEN;
          UNTIL TempReservEntry.NEXT = 0;
        TempReservEntry.DELETEALL;
      END;
    END;

    PROCEDURE ShowDocDim@23();
    VAR
      OldDimSetID@1000 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2',"Document Type","No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF ServItemLineExists OR ServLineExists THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE HandleItemTrackingDeletion@43();
    VAR
      ReservEntry2@1000 : Record 337;
    BEGIN
      ReservEntry.RESET;
      ReservEntry.SETCURRENTKEY(
        "Source ID","Source Ref. No.","Source Type","Source Subtype",
        "Source Batch Name","Source Prod. Order Line","Reservation Status");
      ReservEntry.SETRANGE("Source Type",DATABASE::"Service Line");
      ReservEntry.SETRANGE("Source Subtype","Document Type");
      ReservEntry.SETRANGE("Source ID","No.");
      ReservEntry.SETRANGE("Source Batch Name",'');
      ReservEntry.SETRANGE("Source Prod. Order Line",0);
      ReservEntry.SETFILTER("Item Tracking",'> %1',ReservEntry."Item Tracking"::None);
      IF ReservEntry.ISEMPTY THEN
        EXIT;

      IF HideValidationDialog OR NOT GUIALLOWED THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(Text052,FALSE,LOWERCASE(FORMAT("Document Type")),"No.");

      IF NOT Confirmed THEN
        ERROR('');

      IF ReservEntry.FINDSET THEN
        REPEAT
          ReservEntry2 := ReservEntry;
          ReservEntry2.ClearItemTrackingFields;
          ReservEntry2.MODIFY;
        UNTIL ReservEntry.NEXT = 0;
    END;

    PROCEDURE LookupAdjmtValueEntries@37(QtyType@1000 : 'General,Invoicing');
    VAR
      ItemLedgEntry@1004 : Record 32;
      ServiceLine@1001 : Record 5902;
      ServiceShptLine@1005 : Record 5991;
      TempValueEntry@1003 : TEMPORARY Record 5802;
    BEGIN
      ServiceLine.SETRANGE("Document Type","Document Type");
      ServiceLine.SETRANGE("Document No.","No.");
      TempValueEntry.RESET;
      TempValueEntry.DELETEALL;

      CASE "Document Type" OF
        "Document Type"::Order,"Document Type"::Invoice:
          BEGIN
            IF ServiceLine.FINDSET THEN
              REPEAT
                IF (ServiceLine.Type = ServiceLine.Type::Item) AND (ServiceLine.Quantity <> 0) THEN
                  IF ServiceLine."Shipment No." <> '' THEN BEGIN
                    ServiceShptLine.SETRANGE("Document No.",ServiceLine."Shipment No.");
                    ServiceShptLine.SETRANGE("Line No.",ServiceLine."Shipment Line No.");
                  END ELSE BEGIN
                    ServiceShptLine.SETCURRENTKEY("Order No.","Order Line No.");
                    ServiceShptLine.SETRANGE("Order No.",ServiceLine."Document No.");
                    ServiceShptLine.SETRANGE("Order Line No.",ServiceLine."Line No.");
                  END;
                ServiceShptLine.SETRANGE(Correction,FALSE);
                IF QtyType = QtyType::Invoicing THEN
                  ServiceShptLine.SETFILTER("Qty. Shipped Not Invoiced",'<>0');

                IF ServiceShptLine.FINDSET THEN
                  REPEAT
                    ServiceShptLine.FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
                    IF ItemLedgEntry.FINDSET THEN
                      REPEAT
                        CreateTempAdjmtValueEntries(TempValueEntry,ItemLedgEntry."Entry No.");
                      UNTIL ItemLedgEntry.NEXT = 0;
                  UNTIL ServiceShptLine.NEXT = 0;
              UNTIL ServiceLine.NEXT = 0;
          END;
      END;
      PAGE.RUNMODAL(0,TempValueEntry);
    END;

    LOCAL PROCEDURE CreateTempAdjmtValueEntries@38(VAR TempValueEntry@1001 : TEMPORARY Record 5802;ItemLedgEntryNo@1000 : Integer);
    VAR
      ValueEntry@1002 : Record 5802;
    BEGIN
      ValueEntry.SETCURRENTKEY("Item Ledger Entry No.");
      ValueEntry.SETRANGE("Item Ledger Entry No.",ItemLedgEntryNo);
      IF ValueEntry.FINDSET THEN
        REPEAT
          IF ValueEntry.Adjustment THEN BEGIN
            TempValueEntry := ValueEntry;
            IF TempValueEntry.INSERT THEN;
          END;
        UNTIL ValueEntry.NEXT = 0;
    END;

    PROCEDURE CalcInvDiscForHeader@45();
    VAR
      ServiceInvDisc@1000 : Codeunit 5950;
    BEGIN
      ServiceInvDisc.CalculateIncDiscForHeader(Rec);
    END;

    PROCEDURE SetSecurityFilterOnRespCenter@42();
    BEGIN
      IF UserSetupMgt.GetServiceFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETRANGE("Responsibility Center",UserSetupMgt.GetServiceFilter);
        FILTERGROUP(0);
      END;

      SETRANGE("Date Filter",0D,WORKDATE - 1);
    END;

    LOCAL PROCEDURE UpdatePmtDiscDate@44();
    BEGIN
      IF "Payment Discount %" = 0 THEN
        IF "Document Type" <> "Document Type"::"Credit Memo" THEN
          "Pmt. Discount Date" := "Due Date";
    END;

    LOCAL PROCEDURE CheckMandSalesPersonOrderData@40(ServiceMgtSetup@1000 : Record 5911);
    BEGIN
      IF ServiceMgtSetup."Salesperson Mandatory" THEN
        TESTFIELD("Salesperson Code");

      IF "Document Type" = "Document Type"::Order THEN BEGIN
        IF ServiceMgtSetup."Service Order Type Mandatory" AND ("Service Order Type" = '') THEN
          ERROR(Text018,
            FIELDCAPTION("Service Order Type"),TABLECAPTION,
            FIELDCAPTION("Document Type"),FORMAT("Document Type"),
            FIELDCAPTION("No."),FORMAT("No."));
        IF ServiceMgtSetup."Service Order Start Mandatory" THEN BEGIN
          TESTFIELD("Starting Date");
          TESTFIELD("Starting Time");
        END;
        IF ServiceMgtSetup."Service Order Finish Mandatory" THEN BEGIN
          TESTFIELD("Finishing Date");
          TESTFIELD("Finishing Time");
        END;
        IF ServiceMgtSetup."Fault Reason Code Mandatory" AND NOT ValidatingFromLines THEN BEGIN
          ServItemLine.RESET;
          ServItemLine.SETRANGE("Document Type","Document Type");
          ServItemLine.SETRANGE("Document No.","No.");
          IF ServItemLine.FIND('-') THEN
            REPEAT
              ServItemLine.TESTFIELD("Fault Reason Code");
            UNTIL ServItemLine.NEXT = 0;
        END;
      END;
    END;

    PROCEDURE InventoryPickConflict@47(DocType@1004 : 'Quote,Order,Invoice,Credit Memo';DocNo@1003 : Code[20];ShippingAdvice@1002 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseActivityLine@1000 : Record 5767;
      ServiceLine@1001 : Record 5902;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseActivityLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.");
      WarehouseActivityLine.SETRANGE("Source Type",DATABASE::"Service Line");
      WarehouseActivityLine.SETRANGE("Source Subtype",DocType);
      WarehouseActivityLine.SETRANGE("Source No.",DocNo);
      IF WarehouseActivityLine.ISEMPTY THEN
        EXIT(FALSE);
      ServiceLine.SETRANGE("Document Type",DocType);
      ServiceLine.SETRANGE("Document No.",DocNo);
      ServiceLine.SETRANGE(Type,ServiceLine.Type::Item);
      IF ServiceLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    PROCEDURE InvPickConflictResolutionTxt@48() : Text[500];
    BEGIN
      EXIT(STRSUBSTNO(Text062,TABLECAPTION,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice")));
    END;

    PROCEDURE WhseShpmntConflict@52(DocType@1002 : 'Quote,Order,Invoice,Credit Memo';DocNo@1001 : Code[20];ShippingAdvice@1000 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseShipmentLine@1003 : Record 7321;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseShipmentLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.","Source Line No.");
      WarehouseShipmentLine.SETRANGE("Source Type",DATABASE::"Service Line");
      WarehouseShipmentLine.SETRANGE("Source Subtype",DocType);
      WarehouseShipmentLine.SETRANGE("Source No.",DocNo);
      IF WarehouseShipmentLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    PROCEDURE WhseShpmtConflictResolutionTxt@54() : Text[500];
    BEGIN
      EXIT(STRSUBSTNO(Text063,TABLECAPTION,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice")));
    END;

    LOCAL PROCEDURE GetShippingTime@49(CalledByFieldNo@1000 : Integer);
    VAR
      ShippingAgentServices@1001 : Record 5790;
    BEGIN
      IF (CalledByFieldNo <> CurrFieldNo) AND (CurrFieldNo <> 0) THEN
        EXIT;

      IF ShippingAgentServices.GET("Shipping Agent Code","Shipping Agent Service Code") THEN
        "Shipping Time" := ShippingAgentServices."Shipping Time"
      ELSE BEGIN
        GetCust("Customer No.");
        "Shipping Time" := Cust."Shipping Time"
      END;
      IF NOT (CalledByFieldNo IN [FIELDNO("Shipping Agent Code"),FIELDNO("Shipping Agent Service Code")]) THEN
        VALIDATE("Shipping Time");
    END;

    LOCAL PROCEDURE CheckHeaderDimension@46();
    BEGIN
      IF ("Contract No." <> '') AND ("Document Type" = "Document Type"::Invoice) THEN
        ERROR(Text066);
    END;

    LOCAL PROCEDURE CreateServiceLines@50(VAR TempServLine@1004 : TEMPORARY Record 5902;VAR ExtendedTextAdded@1000 : Boolean);
    BEGIN
      ServLine.INIT;
      ServLine."Line No." := 0;
      TempServLine.FIND('-');
      ExtendedTextAdded := FALSE;

      REPEAT
        IF TempServLine."Attached to Line No." = 0 THEN BEGIN
          ServLine.INIT;
          ServLine.SetHideReplacementDialog(TRUE);
          ServLine.SetHideCostWarning(TRUE);
          ServLine."Line No." := ServLine."Line No." + 10000;
          ServLine.VALIDATE(Type,TempServLine.Type);
          IF TempServLine."No." <> '' THEN BEGIN
            ServLine.VALIDATE("No.",TempServLine."No.");
            IF ServLine.Type <> ServLine.Type::" " THEN BEGIN
              ServLine.VALIDATE("Unit of Measure Code",TempServLine."Unit of Measure Code");
              ServLine.VALIDATE("Variant Code",TempServLine."Variant Code");
              IF TempServLine.Quantity <> 0 THEN
                ServLine.VALIDATE(Quantity,TempServLine.Quantity);
            END;
          END;

          ServLine."Serv. Price Adjmt. Gr. Code" := TempServLine."Serv. Price Adjmt. Gr. Code";
          ServLine."Document No." := TempServLine."Document No.";
          ServLine."Service Item No." := TempServLine."Service Item No.";
          ServLine."Appl.-to Service Entry" := TempServLine."Appl.-to Service Entry";
          ServLine."Service Item Line No." := TempServLine."Service Item Line No.";
          ServLine.VALIDATE(Description,TempServLine.Description);
          ServLine.VALIDATE("Description 2",TempServLine."Description 2");

          IF TempServLine."No." <> '' THEN BEGIN
            TempLinkToServItem := "Link Service to Service Item";
            IF "Link Service to Service Item" THEN BEGIN
              "Link Service to Service Item" := FALSE;
              MODIFY(TRUE);
            END;
            ServLine."Spare Part Action" := TempServLine."Spare Part Action";
            ServLine."Component Line No." := TempServLine."Component Line No.";
            ServLine."Replaced Item No." := TempServLine."Replaced Item No.";
            ServLine.VALIDATE("Work Type Code",TempServLine."Work Type Code");

            ServLine."Location Code" := TempServLine."Location Code";
            IF ServLine.Type <> ServLine.Type::" " THEN BEGIN
              IF ServLine.Type = ServLine.Type::Item THEN BEGIN
                ServLine.VALIDATE("Variant Code",TempServLine."Variant Code");
                IF ServLine."Location Code" <> '' THEN
                  ServLine."Bin Code" := TempServLine."Bin Code";
              END;
              ServLine."Fault Reason Code" := TempServLine."Fault Reason Code";
              ServLine."Exclude Warranty" := TempServLine."Exclude Warranty";
              ServLine."Exclude Contract Discount" := TempServLine."Exclude Contract Discount";
              ServLine.VALIDATE("Contract No.",TempServLine."Contract No.");
              ServLine.VALIDATE(Warranty,TempServLine.Warranty);
            END;
            ServLine."Fault Area Code" := TempServLine."Fault Area Code";
            ServLine."Symptom Code" := TempServLine."Symptom Code";
            ServLine."Resolution Code" := TempServLine."Resolution Code";
            ServLine."Fault Code" := TempServLine."Fault Code";
          END;
          "Link Service to Service Item" := TempLinkToServItem;

          ServLine.INSERT;
          ExtendedTextAdded := FALSE;
        END ELSE
          IF NOT ExtendedTextAdded THEN BEGIN
            TransferExtendedText.ServCheckIfAnyExtText(ServLine,TRUE);
            TransferExtendedText.InsertServExtText(ServLine);
            ServLine.FIND('+');
            ExtendedTextAdded := TRUE;
          END;
        RecreateReservEntry(TempServLine,ServLine."Line No.",FALSE);
      UNTIL TempServLine.NEXT = 0;
    END;

    BEGIN
    END.
  }
}

